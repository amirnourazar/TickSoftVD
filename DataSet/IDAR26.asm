

;
; ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»
; º	This file is generated by The Interactive Disassembler (IDA)	    º
; º	Copyright (c) 2003 by DataRescue sa/nv,	<ida@datarescue.com>	    º
; º Licensed to: Mark Stamp, San Jose State University,	1 user,	academic, 11/2003 º
; ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼
;
; File Name   :	C:\Documents and Settings\Fiona\My Documents\CS	298_Metamorphic	virus\HMM\Cygwin\mlock.exe
; Format      :	Portable executable for	IBM PC (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00000E14 (   3604.)
; Section size in file		: 00001000 (   4096.)
; Offset to raw	data for section: 00000400
; Flags	60000060: Text Data Executable Readable
; Alignment	: 16 bytes ?

		model flat

; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Pure code
; Segment permissions: Read/Execute
_text		segment	para public 'CODE' use32
		assume cs:_text
		;org 401000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ

; Attributes: bp-based frame

		public start
start		proc near

var_8		= dword	ptr -8
var_2		= word ptr -2

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, ds:dword_403000
		test	eax, eax
		jz	short loc_401010
		int	3		; Trap to Debugger

loc_401010:				; CODE XREF: start+Dj
		fnstcw	[ebp+var_2]
		movzx	eax, [ebp+var_2]
		and	eax, 0FFFFF0C0h
		mov	[ebp+var_2], ax
		movzx	eax, [ebp+var_2]
		or	eax, 33Fh
		mov	[ebp+var_2], ax
		fldcw	[ebp+var_2]
		mov	[esp+8+var_8], (offset loc_40117A+5)
		call	sub_401920
		mov	esp, ebp
		pop	ebp
		retn
start		endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_401040:				; CODE XREF: .text:00401DF4j
		push	ebp
		mov	ebp, esp
		pop	ebp
		jmp	loc_401680
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 8
dword_401050	dd 29752528h, 732520h	; DATA XREF: .text:00401071o
byte_401058	db 3Fh,	0		; DATA XREF: .text:0040108Do
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_40105A:				; CODE XREF: .text:004011EFp
					; .text:00401209p ...
		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[ebp-4], ebx
		mov	ebx, [ebp+0Ch]
		mov	eax, [ebp+8]
		mov	[esp+0Ch], eax
		mov	[esp+8], ebx
		mov	dword ptr [esp+4], offset dword_401050
		mov	dword ptr [esp], 5
		call	syslog
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], offset byte_401058
		mov	dword ptr [esp], 1
		call	write
		mov	[esp], ebx
		call	_exit

loc_4010A9:				; DATA XREF: .text:004011A7o
		ins	dword ptr es:[edi], dx
		popa
		imul	ebp, [eax+eax+6Eh], 7320746Fh
		db	65h
		jz	short loc_40111D
		imul	esp, [eax+6Dh],	6C6961h

loc_4010BE:				; DATA XREF: .text:00401202o
		imul	ebp, [esi+76h],	64696C61h
		and	[ecx+72h], ah
		db	67h
		jnz	near ptr 1138h
		outs	dx, byte ptr gs:[esi]
		jz	short near ptr loc_40113F+3
		add	[ecx+6Eh], ch
		jbe	short loc_401135
		ins	byte ptr es:[edi], dx
		imul	esp, [eax+66h],	616D0064h
		ins	byte ptr es:[edi], dx
		ins	byte ptr es:[edi], dx
		outsd
		arpl	[eax], sp
		popaw
		imul	ebp, [ebp+esi*2+72h], 73660065h
		jz	short near ptr loc_40114E+1
		jz	short loc_401110
		popaw
		imul	ebp, [ebp+esi*2+72h], 64660065h
		and	[esi+6Fh], ch
		jz	short near ptr loc_40111D+2
		jb	short near ptr loc_401164+2
		db	67h
		jnz	near ptr 1170h
		popa
		jb	short near ptr loc_401125+2
		imul	bp, [ebp+0], 736Ch
		jz	short loc_401171

loc_401110:				; CODE XREF: .text:004010EEj
		jz	short loc_401132
		popaw
		imul	ebp, [ebp+esi*2+72h], 616E0065h
		ins	dword ptr es:[edi], dx

loc_40111D:				; CODE XREF: .text:004010B3j
					; .text:004010FDj
		and	gs:[esi+6Fh], ch
		jz	short loc_401143
		jb	short near ptr loc_401185+5

loc_401125:				; CODE XREF: .text:00401105j
		db	67h
		jnz	near ptr 1194h
		popa
		jb	short loc_40114B
		imul	bp, [ebp+0], 6466h

loc_401132:				; CODE XREF: .text:00401110j
		and	[ecx+6Eh], ah

loc_401135:				; CODE XREF: .text:004010D2j
		and	fs:[esi+61h], ch
		ins	dword ptr es:[edi], dx
		and	gs:[ecx+ebp*2+66h], ah

loc_40113F:				; CODE XREF: .text:004010CDj
		db	66h, 65h
		jb	short near ptr loc_4011A7+1

loc_401143:				; CODE XREF: .text:00401121j
		outsb
		jz	short $+2

loc_401146:				; DATA XREF: .text:0040139Co
		and	eax, 6F6C2E73h

loc_40114B:				; CODE XREF: .text:00401129j
		arpl	[ebx+0], bp

loc_40114E:				; CODE XREF: .text:004010ECj
		mov	esi, esi

loc_401150:				; DATA XREF: .text:004013E8o
		db	65h
		js	short near ptr loc_4011B5+7
		jnb	short near ptr loc_4011C8+1
		imul	ebp, [esi+67h],	636F6C20h
		imul	esp, [eax], 6Eh
		outsd
		jz	short loc_401182
		jb	short near ptr loc_4011C8+1

loc_401164:				; CODE XREF: .text:004010FFj
		db	67h
		jnz	near ptr 11D3h
		popa
		jb	short near ptr loc_401185+5
		imul	bp, [ebp+0], 7325h

loc_401171:				; CODE XREF: .text:0040110Ej
		db	2Eh
		and	eax, 252E756Ch
		ins	byte ptr es:[edi], dx
		jnz	short near ptr loc_4011A7+1

loc_40117A:				; DATA XREF: .text:00401535o
					; .text:00401571o ...
		add	ds:55002B00h, ch
		mov	ebp, esp

loc_401182:				; CODE XREF: .text:00401160j
		push	edi
		push	esi
		push	ebx

loc_401185:				; CODE XREF: .text:00401123j
					; .text:00401168j
		sub	esp, 4FCh
		and	esp, 0FFFFFFF0h
		mov	eax, 0
		call	sub_4018F0
		call	__main
		mov	dword ptr [ebp-4DCh], 12Bh

loc_4011A7:				; CODE XREF: .text:0040113Fj
					; .text:00401178j
		mov	dword ptr [esp], offset	loc_4010A9
		call	_getgrnam32
		mov	ebx, eax

loc_4011B5:				; CODE XREF: .text:00401150j
		mov	dword ptr [esp+8], 10h
		mov	dword ptr [esp+4], 1
		mov	edx, [ebp+0Ch]

loc_4011C8:				; CODE XREF: .text:00401153j
					; .text:00401162j
		mov	eax, [edx]
		mov	[esp], eax
		call	openlog
		test	ebx, ebx
		jz	short loc_4011E0
		call	_getegid32
		cmp	[ebx+8], eax
		jz	short loc_4011F4

loc_4011E0:				; CODE XREF: .text:004011D4j
		mov	dword ptr [esp+4], 40h
		mov	dword ptr [esp], 4010AEh
		call	loc_40105A

loc_4011F4:				; CODE XREF: .text:004011DEj
		cmp	dword ptr [ebp+8], 3
		jz	short loc_40120E
		mov	dword ptr [esp+4], 40h
		mov	dword ptr [esp], offset	loc_4010BE
		call	loc_40105A

loc_40120E:				; CODE XREF: .text:004011F8j
		mov	eax, [ebp+0Ch]
		mov	ebx, [eax+4]
		cmp	byte ptr [ebx],	0
		jz	short loc_401242

loc_401219:				; CODE XREF: .text:00401240j
		movsx	edx, byte ptr [ebx]
		mov	eax, ds:_ctype_
		test	byte ptr [edx+eax+1], 4
		jnz	short loc_40123C
		mov	dword ptr [esp+4], 40h
		mov	dword ptr [esp], 4010D0h
		call	loc_40105A

loc_40123C:				; CODE XREF: .text:00401226j
		inc	ebx
		cmp	byte ptr [ebx],	0
		jnz	short loc_401219

loc_401242:				; CODE XREF: .text:00401217j
		mov	edx, [ebp+0Ch]
		mov	edi, [edx+8]
		cld
		mov	ecx, 0FFFFFFFFh
		mov	al, 0
		repne scasb
		mov	ebx, ecx
		not	ebx
		lea	eax, [ebx+5]
		mov	[esp], eax
		call	malloc
		mov	[ebp-4E0h], eax
		lea	eax, [ebx+6Dh]
		mov	[esp], eax
		call	malloc
		mov	esi, eax
		cmp	dword ptr [ebp-4E0h], 0
		jz	short loc_401281
		test	eax, eax
		jnz	short loc_401298

loc_401281:				; CODE XREF: .text:0040127Bj
		call	__errno
		mov	eax, [eax]
		mov	[esp+4], eax
		mov	dword ptr [esp], 4010DBh
		call	loc_40105A

loc_401298:				; CODE XREF: .text:0040127Fj
		mov	edx, [ebp+0Ch]
		mov	eax, [edx+4]
		mov	[esp], eax
		call	atoi
		lea	edx, [ebp-4D8h]
		mov	[esp+4], edx
		mov	[esp], eax
		call	_fstat64
		test	eax, eax
		jz	short loc_4012D3
		call	__errno
		mov	eax, [eax]
		mov	[esp+4], eax
		mov	dword ptr [esp], 4010EAh
		call	loc_40105A

loc_4012D3:				; CODE XREF: .text:004012BAj
		mov	eax, [ebp-4C8h]
		and	eax, 0F000h
		cmp	eax, 8000h
		jz	short loc_4012F9
		mov	dword ptr [esp+4], 40h
		mov	dword ptr [esp], 4010F8h
		call	loc_40105A

loc_4012F9:				; CODE XREF: .text:004012E3j
		lea	eax, [ebp-478h]
		mov	[esp+4], eax
		mov	edx, [ebp+0Ch]
		mov	eax, [edx+8]
		mov	[esp], eax
		call	_lstat64
		test	eax, eax
		jz	short loc_40132C
		call	__errno
		mov	eax, [eax]
		mov	[esp+4], eax
		mov	dword ptr [esp], 40110Ch
		call	loc_40105A

loc_40132C:				; CODE XREF: .text:00401313j
		mov	eax, [ebp-468h]
		and	eax, 0F000h
		cmp	eax, 8000h
		jz	short loc_401352
		mov	dword ptr [esp+4], 40h
		mov	dword ptr [esp], 40111Ah
		call	loc_40105A

loc_401352:				; CODE XREF: .text:0040133Cj
		mov	eax, [ebp-478h]
		cmp	eax, [ebp-4D8h]
		jnz	short loc_40137E
		mov	eax, [ebp-470h]
		mov	edx, [ebp-46Ch]
		mov	ecx, [ebp-4CCh]
		xor	ecx, edx
		xor	eax, [ebp-4D0h]
		or	ecx, eax
		jz	short loc_401392

loc_40137E:				; CODE XREF: .text:0040135Ej
		mov	dword ptr [esp+4], 40h
		mov	dword ptr [esp], 401130h
		call	loc_40105A

loc_401392:				; CODE XREF: .text:0040137Cj
		mov	edx, [ebp+0Ch]
		mov	eax, [edx+8]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], offset loc_401146
		mov	eax, [ebp-4E0h]
		mov	[esp], eax
		call	sprintf
		lea	eax, [ebp-478h]
		mov	[esp+4], eax
		mov	edx, [ebp-4E0h]
		mov	[esp], edx
		call	_lstat64
		test	eax, eax
		jnz	short loc_4013F4
		mov	eax, [ebp-468h]
		and	eax, 0F000h
		cmp	eax, 8000h
		jz	short loc_4013F4
		mov	dword ptr [esp+4], 4Dh
		mov	dword ptr [esp], offset	loc_401150
		call	loc_40105A

loc_4013F4:				; CODE XREF: .text:004013CCj
					; .text:004013DEj ...
		mov	dword ptr [esp], 0
		call	time
		mov	[ebp-4E4h], eax
		call	getpid
		mov	ebx, eax
		mov	dword ptr [esp], 0
		call	time
		mov	[esp+10h], ebx
		mov	[esp+0Ch], eax
		mov	eax, [ebp-4E0h]
		mov	[esp+8], eax
		mov	dword ptr [esp+4], 40116Fh
		mov	[esp], esi
		call	sprintf
		mov	edi, esi
		cld
		mov	ecx, 0FFFFFFFFh
		mov	al, 0
		repne scasb
		not	ecx
		mov	dword ptr [esp+4], 40h
		lea	ecx, [esi+ecx-1]
		mov	[esp], ecx
		call	gethostname
		mov	dword ptr [esp+8], 1FDh
		mov	dword ptr [esp+4], 0A01h
		mov	[esp], esi
		call	_open64
		mov	ebx, eax
		test	eax, eax
		js	loc_40151E
		mov	dword ptr [esp+4], 1FDh
		mov	[esp], esi
		call	chmod
		mov	[esp], ebx
		call	close
		mov	edx, [ebp-4E0h]
		mov	[esp+4], edx
		mov	[esp], esi
		call	link
		lea	eax, [ebp-478h]
		mov	[esp+4], eax
		mov	[esp], esi
		call	_stat64
		mov	[esp], esi
		call	unlink
		cmp	word ptr [ebp-464h], 2
		jz	short loc_4014D4
		mov	ebx, 0FFFFFFFFh
		jmp	short loc_4014D9
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_4014D4:				; CODE XREF: .text:004014CBj
		mov	ebx, 0

loc_4014D9:				; CODE XREF: .text:004014D2j
		test	ebx, ebx
		jz	short loc_40151A
		lea	eax, [ebp-478h]
		mov	[esp+4], eax
		mov	eax, [ebp-4E0h]
		mov	[esp], eax
		call	_stat64
		test	eax, eax
		jnz	short loc_40151A
		mov	eax, [ebp-438h]
		add	eax, 12Ch
		cmp	[ebp-4E4h], eax
		jle	short loc_40151A
		mov	edx, [ebp-4E0h]
		mov	[esp], edx
		call	unlink

loc_40151A:				; CODE XREF: .text:004014DBj
					; .text:004014F7j ...
		test	ebx, ebx
		jns	short loc_401569

loc_40151E:				; CODE XREF: .text:00401479j
		dec	dword ptr [ebp-4DCh]
		cmp	dword ptr [ebp-4DCh], 0FFFFFFFFh
		jnz	short loc_401555
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], (offset loc_40117A+1)
		mov	dword ptr [esp], 1
		call	write
		mov	dword ptr [esp], 49h
		call	_exit

loc_401555:				; CODE XREF: .text:0040152Bj
		mov	dword ptr [esp], 1
		call	sleep
		test	ebx, ebx
		js	loc_4013F4

loc_401569:				; CODE XREF: .text:0040151Cj
		mov	dword ptr [esp+8], 1
		mov	dword ptr [esp+4], (offset loc_40117A+3)
		mov	dword ptr [esp], 1
		call	write
		mov	dword ptr [esp+8], 1
		lea	eax, [ebp-418h]
		mov	[esp+4], eax
		mov	dword ptr [esp], 0
		call	read
		mov	eax, [ebp-4E0h]
		mov	[esp], eax
		call	unlink
		mov	eax, 0
		lea	esp, [ebp-0Ch]
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		dd 4 dup(90909090h)
		align 4
aLibgccw32EhSjl	db '-LIBGCCW32-EH-SJLJ-GTHR-CYGWIN',0 ; DATA XREF: .text:004016A1o
					; sub_4017C0+32o
		align 4

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ

; Attributes: bp-based frame

sub_4015F0	proc near		; DATA XREF: sub_401610+3Do
		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, ds:dword_403040
		call	dword ptr [eax+4]
		mov	esp, ebp
		pop	ebp
		retn
sub_4015F0	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ

; Attributes: bp-based frame

sub_401610	proc near		; CODE XREF: .text:0040172Fp

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		cld
		sub	esp, 8
		mov	ecx, 0Ch
		mov	[esp+8+var_8], ebx
		mov	ebx, [ebp+arg_0]
		mov	[esp+8+var_4], edi
		mov	edi, ebx
		rep stosd
		mov	dword ptr [ebx], 30h
		mov	eax, dword_402000
		mov	dword ptr [ebx+24h], 0FFFFFFFFh
		mov	dword ptr [ebx+4], offset abort
		mov	[ebx+14h], eax
		mov	eax, ds:dword_403010
		mov	dword ptr [ebx+8], offset sub_4015F0
		mov	edx, dword_402008
		mov	dword ptr [ebx+1Ch], 0
		mov	[ebx+20h], eax
		mov	eax, dword_402004
		mov	[ebx+2Ch], edx
		mov	[ebx+28h], eax
		mov	ebx, [esp+8+var_8]
		mov	edi, [esp+8+var_4]
		mov	esp, ebp
		pop	ebp
		retn
sub_401610	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 8

loc_401680:				; CODE XREF: .text:00401044j
		push	ebp
		mov	ebp, esp
		sub	esp, 58h
		mov	[ebp-8], esi
		mov	eax, ds:dword_403040
		mov	[ebp-4], edi
		test	eax, eax
		jz	short loc_4016A0

loc_401695:				; CODE XREF: .text:00401776j
		mov	esi, [ebp-8]
		mov	edi, [ebp-4]
		mov	esp, ebp
		pop	ebp
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 4

loc_4016A0:				; CODE XREF: .text:00401693j
		cld
		mov	esi, offset aLibgccw32EhSjl ; "-LIBGCCW32-EH-SJLJ-GTHR-CYGWIN"
		mov	dword ptr [ebp-48h], 41414141h
		lea	edi, [ebp-28h]
		mov	ecx, 7
		mov	dword ptr [ebp-44h], 41414141h
		mov	dword ptr [ebp-40h], 41414141h
		mov	dword ptr [ebp-3Ch], 41414141h
		mov	dword ptr [ebp-38h], 41414141h
		mov	dword ptr [ebp-34h], 41414141h
		mov	dword ptr [ebp-30h], 41414141h
		mov	dword ptr [ebp-2Ch], 41414141h
		movzx	eax, word ptr ds:aLibgccw32EhSjl+1Ch
		rep movsd
		mov	[edi], ax
		movzx	eax, byte ptr ds:aLibgccw32EhSjl+1Eh
		mov	[edi+2], al
		lea	edi, [ebp-48h]
		mov	[esp], edi
		call	FindAtomA
		movzx	eax, ax
		sub	esp, 4
		test	ax, ax
		jnz	loc_4017A0
		mov	dword ptr [esp], 30h
		call	malloc
		test	eax, eax
		mov	esi, eax
		jz	loc_4017AC
		mov	[esp], eax
		call	sub_401610
		mov	[esp], esi
		call	sub_4017C0
		test	ax, ax
		jz	short loc_40177B
		mov	dword ptr [esp+8], offset sub_4018C0
		mov	dword ptr [esp+4], 0
		mov	dword ptr [esp], 0
		call	pthread_atfork
		lea	esi, [esi+0]

loc_401760:				; CODE XREF: .text:004017AAj
		mov	ds:dword_403040, esi
		lea	eax, [esi+4]
		mov	ds:dword_403030, eax
		lea	eax, [esi+8]
		mov	ds:dword_403050, eax
		jmp	loc_401695
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_40177B:				; CODE XREF: .text:0040173Fj
		mov	[esp], esi
		call	free
		mov	[esp], edi
		call	FindAtomA
		sub	esp, 4
		movzx	eax, ax
		jmp	short loc_4017A0
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h

loc_4017A0:				; CODE XREF: .text:00401710j
					; .text:00401791j
		mov	[esp], eax
		call	sub_401850
		mov	esi, eax
		jmp	short loc_401760
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_4017AC:				; CODE XREF: .text:00401726j
		call	abort
		jmp	short sub_4017C0
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ

; Attributes: bp-based frame

sub_4017C0	proc near		; CODE XREF: .text:00401737p
					; .text:004017B1j ...

var_68		= dword	ptr -68h
var_58		= dword	ptr -58h
var_38		= dword	ptr -38h
var_C		= dword	ptr -0Ch
arg_0		= dword	ptr  8

		push	ebp
		mov	eax, 1Fh
		mov	ebp, esp
		push	edi
		mov	edx, 1
		push	esi
		push	ebx
		sub	esp, 5Ch	; lpString
		mov	ebx, [ebp+arg_0]
		lea	esi, [esi+0]
		lea	edi, [edi+0]

loc_4017E0:				; CODE XREF: sub_4017C0+2Fj
		test	edx, ebx
		mov	cl, 41h
		jnz	short loc_4017E8
		mov	cl, 61h

loc_4017E8:				; CODE XREF: sub_4017C0+24j
		mov	[eax+ebp-58h], cl
		add	edx, edx
		dec	eax
		jns	short loc_4017E0
		cld
		mov	esi, offset aLibgccw32EhSjl ; "-LIBGCCW32-EH-SJLJ-GTHR-CYGWIN"
		lea	edi, [ebp+var_38]
		movzx	eax, word ptr ds:aLibgccw32EhSjl+1Ch
		mov	ecx, 7
		rep movsd
		mov	[edi], ax
		movzx	eax, byte ptr ds:aLibgccw32EhSjl+1Eh
		mov	[edi+2], al
		lea	eax, [ebp+var_58]
		mov	[esp+68h+var_68], eax
		call	AddAtomA
		movzx	esi, ax
		sub	esp, 4
		test	si, si
		jnz	short loc_401837

loc_40182B:				; CODE XREF: sub_4017C0+83j
		xor	edx, edx

loc_40182D:				; CODE XREF: sub_4017C0+85j
		lea	esp, [ebp+var_C]
		mov	eax, edx
		pop	ebx
		pop	esi
		pop	edi
		pop	ebp
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_401837:				; CODE XREF: sub_4017C0+69j
		mov	[esp+68h+var_68], esi
		call	sub_401850
		cmp	eax, ebx
		mov	edx, esi
		jnz	short loc_40182B
		jmp	short loc_40182D
sub_4017C0	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ

; Attributes: bp-based frame

sub_401850	proc near		; CODE XREF: .text:004017A3p
					; sub_4017C0+7Ap

var_58		= dword	ptr -58h
var_54		= dword	ptr -54h
var_50		= dword	ptr -50h
var_48		= dword	ptr -48h
var_4		= dword	ptr -4
arg_0		= word ptr  8

		push	ebp
		mov	ebp, esp
		lea	edx, [ebp+var_48]
		push	ebx
		sub	esp, 54h	; nAtom
		xor	ebx, ebx
		movzx	eax, [ebp+arg_0]
		mov	[esp+58h+var_50], 3Fh
		mov	[esp+58h+var_54], edx
		mov	[esp+58h+var_58], eax
		call	GetAtomNameA
		sub	esp, 0Ch
		test	eax, eax
		jz	short loc_4018AC
		mov	eax, 1Fh
		mov	edx, 1
		lea	esi, [esi+0]
		lea	edi, [edi+0]

loc_401890:				; CODE XREF: sub_401850+4Aj
		cmp	byte ptr [eax+ebp-48h],	41h
		jz	short loc_4018A8

loc_401897:				; CODE XREF: sub_401850+5Aj
		add	edx, edx
		dec	eax
		jns	short loc_401890
		cmp	dword ptr [ebx], 30h
		jnz	short loc_4018AC
		mov	eax, ebx
		mov	ebx, [ebp+var_4]
		leave
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_4018A8:				; CODE XREF: sub_401850+45j
		or	ebx, edx
		jmp	short loc_401897
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_4018AC:				; CODE XREF: sub_401850+29j
					; sub_401850+4Fj
		call	abort
		jmp	short sub_4018C0
sub_401850	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ

; Attributes: bp-based frame

sub_4018C0	proc near		; CODE XREF: sub_401850+61j
					; DATA XREF: .text:00401741o

var_8		= dword	ptr -8

		push	ebp
		mov	ebp, esp
		sub	esp, 8
		mov	eax, ds:dword_403040
		mov	[esp+8+var_8], eax
		call	sub_4017C0
		test	ax, ax
		jz	short loc_4018DC
		mov	esp, ebp
		pop	ebp
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_4018DC:				; CODE XREF: sub_4018C0+16j
		call	abort
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
		nop
sub_4018C0	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_4018F0	proc near		; CODE XREF: .text:00401193p
		push	ecx
		mov	ecx, esp
		add	ecx, 8

loc_4018F6:				; CODE XREF: sub_4018F0+1Bj
		cmp	eax, 1000h
		jb	short loc_40190D
		sub	ecx, 1000h
		or	dword ptr [ecx], 0
		sub	eax, 1000h
		jmp	short loc_4018F6
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_40190D:				; CODE XREF: sub_4018F0+Bj
		sub	ecx, eax
		or	dword ptr [ecx], 0
		mov	eax, esp
		mov	esp, ecx
		mov	ecx, [eax]
		mov	eax, [eax+4]
		jmp	eax
sub_4018F0	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 4

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ

; Attributes: bp-based frame

sub_401920	proc near		; CODE XREF: start+37p

var_C8		= dword	ptr -0C8h
var_C4		= dword	ptr -0C4h
var_C0		= dword	ptr -0C0h
var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[ebp+var_4], esi
		mov	esi, [ebp+arg_0]
		mov	[ebp+var_8], ebx
		xor	ebx, ebx
		mov	[esp+18h+var_14], 0
		mov	[esp+18h+var_18], esi
		call	sub_401B30
		sub	esp, 8
		test	eax, eax
		jz	short loc_401951

loc_401948:				; CODE XREF: sub_401920+52j
		mov	[esp+18h+var_18], ebx
		call	ds:dll_crt0__FP11per_process ; dll_crt0(per_process *)

loc_401951:				; CODE XREF: sub_401920+26j
		sub	esp, 0B0h
		lea	ebx, [esp+0C8h+var_C0]
		mov	[esp+0C8h+var_C0], 0
		mov	[esp+0C8h+var_C4], ebx
		mov	[esp+0C8h+var_C8], esi
		call	sub_401B30
		sub	esp, 8
		jmp	short loc_401948
sub_401920	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __main. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION read. PRESS KEYPAD "+" TO	EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION write. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION sleep. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION unlink. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _stat64. PRESS KEYPAD "+"	TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION link. PRESS KEYPAD "+" TO	EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION close. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION chmod. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _open64. PRESS KEYPAD "+"	TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION gethostname. PRESS KEYPAD	"+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION getpid. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION time. PRESS KEYPAD "+" TO	EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION sprintf. PRESS KEYPAD "+"	TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _lstat64.	PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION atoi. PRESS KEYPAD "+" TO	EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _fstat64.	PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION __errno. PRESS KEYPAD "+"	TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION malloc. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _getegid32. PRESS	KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION openlog. PRESS KEYPAD "+"	TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _getgrnam32. PRESS KEYPAD	"+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION _exit. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION syslog. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION free. PRESS KEYPAD "+" TO	EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION pthread_atfork. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION abort. PRESS KEYPAD "+" TO EXPAND]
		align 10h

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ

; Attributes: bp-based frame

sub_401B30	proc near		; CODE XREF: sub_401920+1Cp
					; sub_401920+4Ap

var_8		= dword	ptr -8
var_4		= dword	ptr -4
arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch

		push	ebp
		xor	eax, eax
		mov	ebp, esp
		push	ebx
		sub	esp, 4		; lpModuleName
		mov	ebx, [ebp+arg_4]
		test	ebx, ebx
		jz	loc_401C30

loc_401B44:				; CODE XREF: sub_401B30+11Cj
		mov	dword ptr [ebx+4], 0A8h
		xor	ecx, ecx
		mov	edx, 5Eh
		mov	dword ptr [ebx+8], 3EDh
		test	eax, eax
		mov	dword ptr [ebx+0Ch], 5
		mov	[ebx+80h], ecx
		mov	[ebx+84h], edx
		mov	dword ptr [ebx+2Ch], offset dword_401E00
		mov	dword ptr [ebx+30h], offset dword_401E0C
		mov	dword ptr [ebx+14h], offset unk_403020
		jz	loc_401C24
		mov	eax, [ebx+0A4h]
		mov	ds:dword_403024, eax

loc_401B94:				; CODE XREF: sub_401B30+FBj
		mov	dword ptr [ebx+78h], 0
		mov	eax, [ebp+arg_0]
		mov	dword ptr [ebx+48h], offset sub_401D90
		mov	dword ptr [ebx+4Ch], offset sub_401D80
		mov	[ebx+28h], eax
		mov	eax, [ebp+0]
		mov	dword ptr [ebx+50h], offset sub_401D70
		mov	dword ptr [ebx+54h], offset sub_401D60
		mov	dword ptr [ebx+24h], offset unk_403028
		mov	[ebx], eax
		mov	dword ptr [ebx+18h], offset malloc
		mov	dword ptr [ebx+1Ch], offset free
		mov	dword ptr [ebx+20h], offset loc_401D50
		mov	dword ptr [ebx+44h], offset loc_401D40
		mov	[esp+8+var_8], 0
		call	GetModuleHandleA
		mov	[ebx+7Ch], eax
		sub	esp, 4
		mov	dword ptr [ebx+34h], offset dword_402000
		mov	dword ptr [ebx+38h], offset unk_402010
		mov	dword ptr [ebx+3Ch], offset dword_403000
		mov	dword ptr [ebx+40h], 403080h
		call	sub_401D10
		mov	eax, 1

loc_401C1D:				; CODE XREF: sub_401B30+113j
		mov	ebx, [ebp+var_4]
		leave
		retn	8
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_401C24:				; CODE XREF: sub_401B30+53j
		mov	dword ptr [ebx+10h], offset dword_403024
		jmp	loc_401B94
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_401C30:				; CODE XREF: sub_401B30+Ej
		mov	[esp+8+var_8], 8
		call	cygwin_internal
		mov	edx, eax
		xor	eax, eax
		cmp	edx, 0FFFFFFFFh
		jz	short loc_401C1D
		mov	ebx, edx
		mov	eax, 1
		jmp	loc_401B44
sub_401B30	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h
		jmp	ds:dll_crt0__FP11per_process ; dll_crt0(per_process *)
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h
		jmp	ds:__imp__stat64
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h
		jmp	ds:__imp__open64
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h
		jmp	ds:__imp__lstat64
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h
		jmp	ds:__imp__fstat64
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h
		jmp	ds:__imp__getegid32
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h
		jmp	ds:__imp__getgrnam32
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ

; Attributes: bp-based frame

sub_401CD0	proc near		; CODE XREF: sub_401D10+1Dp

arg_0		= dword	ptr  8
arg_4		= dword	ptr  0Ch
arg_8		= dword	ptr  10h

		push	ebp
		mov	ebp, esp
		mov	ecx, [ebp+arg_0]
		push	esi
		mov	esi, [ebp+arg_8]
		push	ebx
		mov	ebx, [ebp+arg_4]
		cmp	ecx, ebx
		jnb	short loc_401D02
		lea	esi, [esi+0]
		lea	edi, [edi+0]

loc_401CF0:				; CODE XREF: sub_401CD0+30j
		mov	eax, [ecx+4]
		mov	edx, esi
		add	edx, eax
		mov	eax, [ecx]
		add	ecx, 8
		add	[edx], eax
		cmp	ecx, ebx
		jb	short loc_401CF0

loc_401D02:				; CODE XREF: sub_401CD0+10j
		pop	ebx
		pop	esi
		pop	ebp
		retn
sub_401CD0	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ

; Attributes: bp-based frame

sub_401D10	proc near		; CODE XREF: sub_401B30+E3p

var_18		= dword	ptr -18h
var_14		= dword	ptr -14h
var_10		= dword	ptr -10h

		push	ebp
		mov	ebp, esp
		sub	esp, 18h
		mov	[esp+18h+var_10], 400000h
		mov	[esp+18h+var_14], offset dword_403000
		mov	[esp+18h+var_18], offset dword_403000
		call	sub_401CD0
		mov	esp, ebp
		pop	ebp
		retn
sub_401D10	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h

loc_401D40:				; DATA XREF: sub_401B30+AEo
		jmp	ds:calloc
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h

loc_401D50:				; DATA XREF: sub_401B30+A7o
		jmp	ds:realloc
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ

; Attributes: bp-based frame

sub_401D60	proc near		; DATA XREF: sub_401B30+89o
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401D60	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ

; Attributes: bp-based frame

sub_401D70	proc near		; DATA XREF: sub_401B30+82o
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401D70	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ

; Attributes: bp-based frame

sub_401D80	proc near		; DATA XREF: sub_401B30+75o
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401D80	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ

; Attributes: bp-based frame

sub_401D90	proc near		; DATA XREF: sub_401B30+6Eo
		push	ebp
		mov	ebp, esp
		pop	ebp
		retn
sub_401D90	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION cygwin_internal. PRESS KEYPAD "+"	TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION FindAtomA. PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION AddAtomA.	PRESS KEYPAD "+" TO EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION GetAtomNameA. PRESS KEYPAD "+" TO	EXPAND]
		align 10h
; [00000006 BYTES: COLLAPSED FUNCTION GetModuleHandleA.	PRESS KEYPAD "+" TO EXPAND]
		align 10h
		push	ebp
		mov	ebp, esp
		pop	ebp
		jmp	loc_401040
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		align 8
dword_401E00	dd 0FFFFFFFFh, 401DF0h,	0 ; DATA XREF: sub_401B30+3Eo
dword_401E0C	dd 0FFFFFFFFh, 7Ch dup(0) ; DATA XREF: sub_401B30+45o
_text		ends

; Section 2. (virtual address 00002000)
; Virtual size			: 00000010 (	 16.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00001400
; Flags	C0000040: Data Readable	Writable
; Alignment	: 16 bytes ?
; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Pure data
; Segment permissions: Read/Write
_data		segment	para public 'DATA' use32
		assume cs:_data
		;org 402000h
dword_402000	dd 14h			; DATA XREF: sub_401610+22r
					; sub_401B30+C7o
dword_402004	dd 14h			; DATA XREF: sub_401610+54r
dword_402008	dd 0			; DATA XREF: sub_401610+44r
		db    0	;
		db    0	;
		db    0	;
		db    0	;
unk_402010	db    0	;		; DATA XREF: sub_401B30+CEo
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
		db    0	;
_data		ends

; Section 3. (virtual address 00003000)
; Virtual size			: 00000080 (	128.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00000000
; Flags	C0000080: Bss Readable Writable
; Alignment	: 16 bytes ?
; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Uninitialized
; Segment permissions: Read/Write
_bss		segment	para public 'BSS' use32
		assume cs:_bss
		;org 403000h
		assume es:nothing, ss:nothing, ds:_data, fs:nothing, gs:nothing
dword_403000	dd ?			; DATA XREF: start+6r sub_401B30+D5o ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
dword_403010	dd ?			; DATA XREF: sub_401610+38r
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
unk_403020	db    ?	;		; DATA XREF: sub_401B30+4Co
		db    ?	;
		db    ?	;
		db    ?	;
dword_403024	dd ?			; DATA XREF: sub_401B30+5Fw
					; sub_401B30+F4o
unk_403028	db    ?	;		; DATA XREF: sub_401B30+90o
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
dword_403030	dd ?			; DATA XREF: .text:00401769w
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
dword_403040	dd ?			; DATA XREF: sub_4015F0+6r
					; .text:00401689r ...
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
		db    ?	;
dword_403050	dd ?			; DATA XREF: .text:00401771w
		align 40h
_bss		ends

;
; Imports from cygwin1
;
; Section 4. (virtual address 00004000)
; Virtual size			: 0000047C (   1148.)
; Section size in file		: 00000600 (   1536.)
; Offset to raw	data for section: 00001600
; Flags	C0000040: Data Readable	Writable
; Alignment	: 16 bytes ?
; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Externs
; _idata
		extrn __imp___errno:dword ; DATA XREF: __errnor
		extrn __imp___main:dword ; DATA	XREF: __mainr
		extrn _ctype_:dword	; DATA XREF: .text:0040121Cr
; void __cdecl _imp__exit(int)
		extrn __imp__exit:dword	; DATA XREF: _exitr
		extrn __imp__fstat64:dword ; DATA XREF:	_fstat64r
					; .text:00401CA0r
		extrn __imp__getegid32:dword ; DATA XREF: _getegid32r
					; .text:00401CB0r
		extrn __imp__getgrnam32:dword ;	DATA XREF: _getgrnam32r
					; .text:00401CC0r
		extrn __imp__lstat64:dword ; DATA XREF:	_lstat64r
					; .text:00401C90r
		extrn __imp__open64:dword ; DATA XREF: _open64r
					; .text:00401C80r
		extrn __imp__stat64:dword ; DATA XREF: _stat64r
					; .text:00401C70r
; void _imp_abort(void)
		extrn __imp_abort:dword	; DATA XREF: abortr
; int __cdecl _imp_atoi(const char *)
		extrn __imp_atoi:dword	; DATA XREF: atoir
; void *__cdecl	calloc(size_t,size_t)
		extrn calloc:dword	; DATA XREF: .text:00401D40r
		extrn __imp_chmod:dword	; DATA XREF: chmodr
		extrn __imp_close:dword	; DATA XREF: closer
		extrn __imp_cygwin_internal:dword ; DATA XREF: cygwin_internalr
; dll_crt0(per_process *)
		extrn dll_crt0__FP11per_process:dword ;	DATA XREF: sub_401920+2Br
					; .text:00401C60r
; void __cdecl _imp_free(void *)
		extrn __imp_free:dword	; DATA XREF: freer
; int __stdcall	__imp_gethostname(char *name,int namelen)
		extrn __imp_gethostname:dword ;	DATA XREF: gethostnamer
		extrn __imp_getpid:dword ; DATA	XREF: getpidr
		extrn __imp_link:dword	; DATA XREF: linkr
; void *__cdecl	_imp_malloc(size_t)
		extrn __imp_malloc:dword ; DATA	XREF: mallocr
		extrn __imp_openlog:dword ; DATA XREF: openlogr
		extrn __imp_pthread_atfork:dword ; DATA	XREF: pthread_atforkr
		extrn __imp_read:dword	; DATA XREF: readr
; void *__cdecl	realloc(void *,size_t)
		extrn realloc:dword	; DATA XREF: .text:00401D50r
		extrn __imp_sleep:dword	; DATA XREF: sleepr
		extrn __imp_sprintf:dword ; DATA XREF: sprintfr
		extrn __imp_syslog:dword ; DATA	XREF: syslogr
; time_t __cdecl _imp_time(time_t *)
		extrn __imp_time:dword	; DATA XREF: timer
		extrn __imp_unlink:dword ; DATA	XREF: unlinkr
		extrn __imp_write:dword	; DATA XREF: writer


;
; Imports from KERNEL32
;
; ATOM __stdcall __imp_AddAtomA(LPCSTR lpString)
		extrn __imp_AddAtomA:dword ; DATA XREF:	AddAtomAr
; ATOM __stdcall __imp_FindAtomA(LPCSTR	lpString)
		extrn __imp_FindAtomA:dword ; DATA XREF: FindAtomAr
; UINT __stdcall __imp_GetAtomNameA(ATOM nAtom,LPSTR lpBuffer,int nSize)
		extrn __imp_GetAtomNameA:dword ; DATA XREF: GetAtomNameAr
; HMODULE __stdcall __imp_GetModuleHandleA(LPCSTR lpModuleName)
		extrn __imp_GetModuleHandleA:dword ; DATA XREF:	GetModuleHandleAr



		end start
